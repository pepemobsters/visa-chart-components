/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
var __spreadArray=this&&this.__spreadArray||function(t,i,s){if(s||arguments.length===2)for(var e=0,r=i.length,n;e<r;e++){if(n||!(e in i)){if(!n)n=Array.prototype.slice.call(i,0,e);n[e]=i[e]}}return t.concat(n||Array.prototype.slice.call(i))};System.register(["./p-b3ba95dd.system.js","./p-4fc15c60.system.js","./p-24fea2b7.system.js","./p-e57fb5e1.system.js"],(function(t){"use strict";var i,s,e,r,n,h,a,u,o;return{setters:[function(t){i=t.r;s=t.c;e=t.h;r=t.g},function(t){n=t.U;h=t.s;a=t.e},function(t){u=t.v},function(t){o=t.m}],execute:function(){var f=n.propDefaultValues;var c=function(){function t(){}return t}();c.mainTitle="Circle Packing Title";c.subTitle=f.subTitle.text;c.height=400;c.width=400;c.circlePadding=5;c.margin={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};c.padding={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};c.localization=f.localization;c.dataDepth=5;c.displayDepth=2;c.parentAccessor="parentNode";c.nodeAccessor="childNode";c.sizeAccessor="value";c.colorPalette=f.colorPaletteSequentialGrey;c.dataLabel=f.dataLabelCenter;c.hoverStyle=f.hoverStyle;c.clickStyle=f.clickStyle;c.hoverOpacity=f.hoverOpacity;c.cursor=f.cursor;c.interactionKeys=f.interactionKeys;c.highestHeadingLevel=f.highestHeadingLevel;c.annotations=f.annotations;c.accessibility=f.accessibility;c.animationConfig=f.animationConfig;c.tooltipLabel=f.tooltipLabel;c.showTooltip=f.showTooltip;c.clickHighlight=f.clickHighlight;c.suppressEvents=f.suppressEvents;function l(t){var i=0,s=t.children,e=s&&s.length;if(!e)i=1;else while(--e>=0)i+=s[e].value;t.value=i}function d(){return this.eachAfter(l)}function v(t){var i=this,s,e=[i],r,n,h;do{s=e.reverse(),e=[];while(i=s.pop()){t(i),r=i.children;if(r)for(n=0,h=r.length;n<h;++n){e.push(r[n])}}}while(e.length);return this}function p(t){var i=this,s=[i],e,r;while(i=s.pop()){t(i),e=i.children;if(e)for(r=e.length-1;r>=0;--r){s.push(e[r])}}return this}function g(t){var i=this,s=[i],e=[],r,n,h;while(i=s.pop()){e.push(i),r=i.children;if(r)for(n=0,h=r.length;n<h;++n){s.push(r[n])}}while(i=e.pop()){t(i)}return this}function m(t){return this.eachAfter((function(i){var s=+t(i.data)||0,e=i.children,r=e&&e.length;while(--r>=0)s+=e[r].value;i.value=s}))}function y(t){return this.eachBefore((function(i){if(i.children){i.children.sort(t)}}))}function b(t){var i=this,s=w(i,t),e=[i];while(i!==s){i=i.parent;e.push(i)}var r=e.length;while(t!==s){e.splice(r,0,t);t=t.parent}return e}function w(t,i){if(t===i)return t;var s=t.ancestors(),e=i.ancestors(),r=null;t=s.pop();i=e.pop();while(t===i){r=t;t=s.pop();i=e.pop()}return r}function k(){var t=this,i=[t];while(t=t.parent){i.push(t)}return i}function x(){var t=[];this.each((function(i){t.push(i)}));return t}function W(){var t=[];this.eachBefore((function(i){if(!i.children){t.push(i)}}));return t}function T(){var t=this,i=[];t.each((function(s){if(s!==t){i.push({source:s.parent,target:s})}}));return i}function N(t,i){var s=new K(t),e=+t.value&&(s.value=t.value),r,n=[s],h,a,u,o;if(i==null)i=E;while(r=n.pop()){if(e)r.value=+r.data.value;if((a=i(r.data))&&(o=a.length)){r.children=new Array(o);for(u=o-1;u>=0;--u){n.push(h=r.children[u]=new K(a[u]));h.parent=r;h.depth=r.depth+1}}}return s.eachBefore(I)}function D(){return N(this).eachBefore(P)}function E(t){return t.children}function P(t){t.data=t.data.data}function I(t){var i=0;do{t.height=i}while((t=t.parent)&&t.height<++i)}function K(t){this.data=t;this.depth=this.height=0;this.parent=null}K.prototype=N.prototype={constructor:K,count:d,each:v,eachAfter:g,eachBefore:p,sum:m,sort:y,path:b,ancestors:k,descendants:x,leaves:W,links:T,copy:D};var A=Array.prototype.slice;function M(t){var i=t.length,s,e;while(i){e=Math.random()*i--|0;s=t[i];t[i]=t[e];t[e]=s}return t}function O(t){var i=0,s=(t=M(A.call(t))).length,e=[],r,n;while(i<s){r=t[i];if(n&&S(n,r))++i;else n=q(e=z(e,r)),i=0}return n}function z(t,i){var s,e;if(j(i,t))return[i];for(s=0;s<t.length;++s){if(L(i,t[s])&&j(C(t[s],i),t)){return[t[s],i]}}for(s=0;s<t.length-1;++s){for(e=s+1;e<t.length;++e){if(L(C(t[s],t[e]),i)&&L(C(t[s],i),t[e])&&L(C(t[e],i),t[s])&&j(G(t[s],t[e],i),t)){return[t[s],t[e],i]}}}throw new Error}function L(t,i){var s=t.r-i.r,e=i.x-t.x,r=i.y-t.y;return s<0||s*s<e*e+r*r}function S(t,i){var s=t.r-i.r+1e-6,e=i.x-t.x,r=i.y-t.y;return s>0&&s*s>e*e+r*r}function j(t,i){for(var s=0;s<i.length;++s){if(!S(t,i[s])){return false}}return true}function q(t){switch(t.length){case 1:return _(t[0]);case 2:return C(t[0],t[1]);case 3:return G(t[0],t[1],t[2])}}function _(t){return{x:t.x,y:t.y,r:t.r}}function C(t,i){var s=t.x,e=t.y,r=t.r,n=i.x,h=i.y,a=i.r,u=n-s,o=h-e,f=a-r,c=Math.sqrt(u*u+o*o);return{x:(s+n+u/c*f)/2,y:(e+h+o/c*f)/2,r:(c+r+a)/2}}function G(t,i,s){var e=t.x,r=t.y,n=t.r,h=i.x,a=i.y,u=i.r,o=s.x,f=s.y,c=s.r,l=e-h,d=e-o,v=r-a,p=r-f,g=u-n,m=c-n,y=e*e+r*r-n*n,b=y-h*h-a*a+u*u,w=y-o*o-f*f+c*c,k=d*v-l*p,x=(v*w-p*b)/(k*2)-e,W=(p*g-v*m)/k,T=(d*b-l*w)/(k*2)-r,N=(l*m-d*g)/k,D=W*W+N*N-1,E=2*(n+x*W+T*N),P=x*x+T*T-n*n,I=-(D?(E+Math.sqrt(E*E-4*D*P))/(2*D):P/E);return{x:e+x+W*I,y:r+T+N*I,r:I}}function H(t,i,s){var e=t.x-i.x,r,n,h=t.y-i.y,a,u,o=e*e+h*h;if(o){n=i.r+s.r,n*=n;u=t.r+s.r,u*=u;if(n>u){r=(o+u-n)/(2*o);a=Math.sqrt(Math.max(0,u/o-r*r));s.x=t.x-r*e-a*h;s.y=t.y-r*h+a*e}else{r=(o+n-u)/(2*o);a=Math.sqrt(Math.max(0,n/o-r*r));s.x=i.x+r*e-a*h;s.y=i.y+r*h+a*e}}else{s.x=i.x+s.r;s.y=i.y}}function B(t,i){var s=t.r+i.r-1e-6,e=i.x-t.x,r=i.y-t.y;return s>0&&s*s>e*e+r*r}function V(t){var i=t._,s=t.next._,e=i.r+s.r,r=(i.x*s.r+s.x*i.r)/e,n=(i.y*s.r+s.y*i.r)/e;return r*r+n*n}function $(t){this._=t;this.next=null;this.previous=null}function F(t){if(!(r=t.length))return 0;var i,s,e,r,n,h,a,u,o,f,c;i=t[0],i.x=0,i.y=0;if(!(r>1))return i.r;s=t[1],i.x=-s.r,s.x=i.r,s.y=0;if(!(r>2))return i.r+s.r;H(s,i,e=t[2]);i=new $(i),s=new $(s),e=new $(e);i.next=e.previous=s;s.next=i.previous=e;e.next=s.previous=i;t:for(a=3;a<r;++a){H(i._,s._,e=t[a]),e=new $(e);u=s.next,o=i.previous,f=s._.r,c=i._.r;do{if(f<=c){if(B(u._,e._)){s=u,i.next=s,s.previous=i,--a;continue t}f+=u._.r,u=u.next}else{if(B(o._,e._)){i=o,i.next=s,s.previous=i,--a;continue t}c+=o._.r,o=o.previous}}while(u!==o.next);e.previous=i,e.next=s,i.next=s.previous=s=e;n=V(i);while((e=e.next)!==s){if((h=V(e))<n){i=e,n=h}}s=i.next}i=[s._],e=s;while((e=e.next)!==s)i.push(e._);e=O(i);for(a=0;a<r;++a)i=t[a],i.x-=e.x,i.y-=e.y;return e.r}function J(t){return t==null?null:Q(t)}function Q(t){if(typeof t!=="function")throw new Error;return t}function R(){return 0}function U(t){return function(){return t}}function X(t){return Math.sqrt(t.value)}function Y(){var t=null,i=1,s=1,e=R;function r(r){r.x=i/2,r.y=s/2;if(t){r.eachBefore(Z(t)).eachAfter(tt(e,.5)).eachBefore(it(1))}else{r.eachBefore(Z(X)).eachAfter(tt(R,1)).eachAfter(tt(e,r.r/Math.min(i,s))).eachBefore(it(Math.min(i,s)/(2*r.r)))}return r}r.radius=function(i){return arguments.length?(t=J(i),r):t};r.size=function(t){return arguments.length?(i=+t[0],s=+t[1],r):[i,s]};r.padding=function(t){return arguments.length?(e=typeof t==="function"?t:U(+t),r):e};return r}function Z(t){return function(i){if(!i.children){i.r=Math.max(0,+t(i)||0)}}}function tt(t,i){return function(s){if(e=s.children){var e,r,n=e.length,h=t(s)*i||0,a;if(h)for(r=0;r<n;++r)e[r].r+=h;a=F(e);if(h)for(r=0;r<n;++r)e[r].r-=h;s.r=a+h}}}function it(t){return function(i){var s=i.parent;i.r*=t;if(s){i.x=s.x+t*i.x;i.y=s.y+t*i.y}}}var st="$",et={depth:-1},rt={};function nt(t){return t.id}function ht(t){return t.parentId}function at(){var t=nt,i=ht;function s(s){var e,r,n=s.length,h,a,u,o=new Array(n),f,c,l={};for(r=0;r<n;++r){e=s[r],u=o[r]=new K(e);if((f=t(e,r,s))!=null&&(f+="")){c=st+(u.id=f);l[c]=c in l?rt:u}}for(r=0;r<n;++r){u=o[r],f=i(s[r],r,s);if(f==null||!(f+="")){if(h)throw new Error("multiple roots");h=u}else{a=l[st+f];if(!a)throw new Error("missing: "+f);if(a===rt)throw new Error("ambiguous: "+f);if(a.children)a.children.push(u);else a.children=[u];u.parent=a}}if(!h)throw new Error("no root");h.parent=et;h.eachBefore((function(t){t.depth=t.parent.depth+1;--n})).eachBefore(I);h.parent=null;if(n>0)throw new Error("cycle");return h}s.id=function(i){return arguments.length?(t=Q(i),s):t};s.parentId=function(t){return arguments.length?(i=Q(t),s):i};return s}var ut='.o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}circle-packing .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}circle-packing .annotations{pointer-events:none}circle-packing .annotations .handle{pointer-events:all}circle-packing .label{font:12px "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;text-anchor:middle}circle-packing .label,circle-packing .node--root{pointer-events:none}';var ot=ut;var ft=n.configLocalization,ct=n.getGlobalInstances,lt=n.getActiveLanguageString,dt=n.getContrastingStroke,vt=n.createTextStrokeFilter,pt=n.convertColorsToTextures,gt=n.initializeElementAccess,mt=n.initializeDescriptionRoot,yt=n.setElementFocusHandler,bt=n.setElementAccessID,wt=n.setAccessibilityController,kt=n.hideNonessentialGroups,xt=n.setAccessTitle,Wt=n.setAccessSubtitle,Tt=n.setAccessLongDescription,Nt=n.setAccessExecutiveSummary,Dt=n.setAccessPurpose,Et=n.setAccessContext,Pt=n.setAccessStatistics,It=n.setAccessChartCounts,Kt=n.setAccessStructure,At=n.setAccessAnnotation,Mt=n.retainAccessFocus,Ot=n.checkAccessFocus,zt=n.setElementInteractionAccessState,Lt=n.drawTooltip,St=n.setAccessibilityDescriptionWidth,jt=n.annotate,qt=n.getPadding,_t=n.chartAccessors,Ct=n.checkInteraction,Gt=n.checkClicked,Ht=n.checkHovered,Bt=n.convertVisaColor,Vt=n.getColors,$t=n.getLicenses,Ft=n.getScopedData,Jt=n.initTooltipStyle,Qt=n.transitionEndAll,Rt=n.overrideTitleTooltip,Ut=n.roundTo,Xt=n.scopeDataKeys,Yt=n.visaColors,Zt=n.validateAccessibilityProps,ti=n.validateLocalizationProps,ii=n.findTagLevel,si=n.prepareRenderChange,ei=n.resolveLabelCollision,ri=n.setSubTitle;var ni=t("circle_packing",function(){function t(t){var e=this;i(this,t);this.clickEvent=s(this,"clickEvent",7);this.hoverEvent=s(this,"hoverEvent",7);this.mouseOutEvent=s(this,"mouseOutEvent",7);this.initialLoadEvent=s(this,"initialLoadEvent",7);this.initialLoadEndEvent=s(this,"initialLoadEndEvent",7);this.drawStartEvent=s(this,"drawStartEvent",7);this.drawEndEvent=s(this,"drawEndEvent",7);this.transitionEndEvent=s(this,"transitionEndEvent",7);this.shouldValidateAccessibility=true;this.shouldValidateLocalization=true;this.currentDepth=0;this.zooming=false;this.timer=0;this.delay=200;this.prevent=false;this.updated=false;this.exitSize=0;this.enterSize=0;this.shouldZoom=false;this.shouldValidateInteractionKeys=false;this.shouldDrawInteractionState=false;this.shouldUpdateAnnotations=false;this.shouldResetRoot=false;this.shouldSetColors=false;this.shouldSetSubTitle=false;this.shouldUpdateDisplayDepth=false;this.shouldUpdateLabels=false;this.shouldAddStrokeUnder=false;this.shouldUpdateCursor=false;this.shouldUpdateData=false;this.shouldUpdateTableData=false;this.shouldValidate=false;this.shouldBindInteractivity=false;this.shouldUpdateDescriptionWrapper=false;this.shouldSetChartAccessibilityTitle=false;this.shouldSetChartAccessibilitySubtitle=false;this.shouldSetChartAccessibilityLongDescription=false;this.shouldSetChartAccessibilityExecutiveSummary=false;this.shouldSetChartAccessibilityStatisticalNotes=false;this.shouldSetChartAccessibilityStructureNotes=false;this.shouldSetParentSVGAccessibility=false;this.shouldSetGeometryAccessibilityAttributes=false;this.shouldSetGeometryAriaLabels=false;this.shouldSetGroupAccessibilityAttributes=false;this.shouldSetGroupAccessibilityLabel=false;this.shouldSetChartAccessibilityPurpose=false;this.shouldSetChartAccessibilityContext=false;this.shouldSetChartAccessibilityCount=false;this.shouldSetAnnotationAccessibility=false;this.shouldUpdateLayout=false;this.shouldSetTextures=false;this.shouldSetStrokes=false;this.shouldSetTextStrokes=false;this.shouldSetTagLevels=false;this.shouldRedrawWrapper=false;this.shouldSetIDs=false;this.shouldSetLocalizationConfig=false;this.innerInteractionKeys=[];this.defaultsLoaded={};this.bottomLevel="p";this.topLevel="h2";this.strokes={};this.setCircleFilter=function(t,i,s){return!h(s[i]).classed("moving")&&!e.accessibility.hideStrokes?e.filter:null};this.setIDs=function(){e.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)").attr("id",(function(t){return"circle-in-pack-"+e.generateValidId(t.data.id)}))};this.generateValidId=function(t){var i=t instanceof Date?t.getTime():t;return(i+"-"+e.chartID).replace(/\W/g,"-")};this.setCircleStyle=function(t,i,s){var r=h(s[i].parentNode).datum();var n=r.data.data;var a=e.colorArr[r.depth]||"#fff";var u=Gt(n,e.clickHighlight,e.innerInteractionKeys);var o=Ht(n,e.hoverHighlight,e.innerInteractionKeys);var f=r.depth!==0?u&&e.clickStyle.color?Yt[e.clickStyle.color]||e.clickStyle.color||a:o&&e.hoverStyle.color?Yt[e.hoverStyle.color]||e.hoverStyle.color||a:a:a;h(s[i]).attr("stroke",u?dt(Yt[e.clickStyle.color]||e.clickStyle.color||e.preparedColors[r.depth]):o?dt(Yt[e.hoverStyle.color]||e.hoverStyle.color||e.preparedColors[r.depth]):e.strokes[r.depth]).attr("stroke-width",u?e.clickStyle.strokeWidth||3:o?e.hoverStyle.strokeWidth||2:!e.accessibility.hideStrokes?1:0).attr("stroke-dasharray",o&&!u?"4 3":"");return f};this.localization=c.localization;this.mainTitle=c.mainTitle;this.subTitle=c.subTitle;this.height=c.height;this.width=c.width;this.margin=c.margin;this.padding=c.padding;this.circlePadding=c.circlePadding;this.highestHeadingLevel=c.highestHeadingLevel;this.data=undefined;this.uniqueID=undefined;this.dataDepth=c.dataDepth;this.displayDepth=c.displayDepth;this.parentAccessor=c.parentAccessor;this.nodeAccessor=c.nodeAccessor;this.sizeAccessor=c.sizeAccessor;this.colorPalette=c.colorPalette;this.colors=undefined;this.cursor=c.cursor;this.hoverStyle=c.hoverStyle;this.clickStyle=c.clickStyle;this.hoverOpacity=c.hoverOpacity;this.animationConfig=c.animationConfig;this.showTooltip=c.showTooltip;this.tooltipLabel=c.tooltipLabel;this.dataLabel=c.dataLabel;this.dataKeyNames=undefined;this.annotations=c.annotations;this.accessibility=c.accessibility;this.suppressEvents=c.suppressEvents;this.interactionKeys=undefined;this.hoverHighlight=undefined;this.clickHighlight=c.clickHighlight;this.zoomToNode=undefined}t.prototype.dataWatcher=function(t,i){this.updated=true;this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldValidate=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.titleWatcher=function(t,i){this.shouldValidate=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.subtitleWatcher=function(t,i){this.shouldSetSubTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.headingWatcher=function(t,i){this.shouldRedrawWrapper=true;this.shouldSetTagLevels=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true;this.shouldSetAnnotationAccessibility=true};t.prototype.clusterWatcher=function(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.nodeWatcher=function(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.sizeWatcher=function(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldSetGeometryAriaLabels=true;this.shouldZoom=true};t.prototype.heightWatcher=function(t,i){this.shouldUpdateLayout=true;this.shouldResetRoot=true;this.shouldUpdateData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true};t.prototype.dataDepthWatcher=function(t,i){this.shouldUpdateData=true;this.shouldSetColors=true;this.shouldZoom=true};t.prototype.displayDepthWatcher=function(t,i){this.shouldUpdateDisplayDepth=true;this.shouldZoom=true};t.prototype.circlePaddingWatcher=function(t,i){this.shouldUpdateData=true;this.shouldZoom=true};t.prototype.colorsWatcher=function(t,i){this.shouldSetColors=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true};t.prototype.showTooltipWatcher=function(t,i){this.shouldDrawInteractionState=true};t.prototype.tooltipLabelWatcher=function(t,i){this.shouldUpdateTableData=true;this.shouldSetParentSVGAccessibility=true;this.shouldSetGeometryAriaLabels=true};t.prototype.hoverOpacityWatcher=function(t,i){this.shouldDrawInteractionState=true};t.prototype.interactionStyleWatcher=function(t,i){this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.cursorWatcher=function(t,i){this.shouldUpdateCursor=true};t.prototype.clickWatcher=function(t,i){this.shouldDrawInteractionState=true};t.prototype.hoverWatcher=function(t,i){this.shouldDrawInteractionState=true};t.prototype.zoomWatcher=function(t,i){this.shouldZoom=true};t.prototype.interactionWatcher=function(t,i){this.shouldValidateInteractionKeys=true;this.shouldUpdateTableData=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAriaLabels=true};t.prototype.dataKeyNamesWatcher=function(t,i){this.shouldSetParentSVGAccessibility=true;this.shouldSetGroupAccessibilityLabel=true;this.shouldSetGeometryAriaLabels=true};t.prototype.labelWatcher=function(t,i){this.shouldUpdateTableData=true;this.shouldUpdateLabels=true;this.shouldAddStrokeUnder=true};t.prototype.accessibilityWatcher=function(t,i){this.shouldValidate=true;var s=t&&t.title?t.title:false;var e=i&&i.title?i.title:false;if(s!==e){this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}var r=t&&t.executiveSummary?t.executiveSummary:false;var n=i&&i.executiveSummary?i.executiveSummary:false;if(r!==n){this.shouldSetChartAccessibilityExecutiveSummary=true}var h=t&&t.purpose?t.purpose:false;var a=i&&i.purpose?i.purpose:false;if(h!==a){this.shouldSetChartAccessibilityPurpose=true}var u=t&&t.longDescription?t.longDescription:false;var o=i&&i.longDescription?i.longDescription:false;if(u!==o){this.shouldSetChartAccessibilityLongDescription=true}var f=t&&t.contextExplanation?t.contextExplanation:false;var c=i&&i.contextExplanation?i.contextExplanation:false;if(f!==c){this.shouldSetChartAccessibilityContext=true}var l=t&&t.statisticalNotes?t.statisticalNotes:false;var d=i&&i.statisticalNotes?i.statisticalNotes:false;if(l!==d){this.shouldSetChartAccessibilityStatisticalNotes=true}var v=t&&t.structureNotes?t.structureNotes:false;var p=i&&i.structureNotes?i.structureNotes:false;if(v!==p){this.shouldSetChartAccessibilityStructureNotes=true}var g=t&&t.includeDataKeyNames;var m=i&&i.includeDataKeyNames;var y=t&&t.elementDescriptionAccessor?t.elementDescriptionAccessor:false;var b=i&&i.elementDescriptionAccessor?i.elementDescriptionAccessor:false;if(g!==m||y!==b){if(g!==m){this.shouldSetGroupAccessibilityLabel=true}this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}var w=t&&t.hideTextures?t.hideTextures:false;var k=i&&i.hideTextures?i.hideTextures:false;if(w!==k){this.shouldSetTextures=true;this.shouldDrawInteractionState=true}var x=t&&t.hideStrokes?t.hideStrokes:false;var W=i&&i.hideStrokes?i.hideStrokes:false;if(x!==W){this.shouldSetStrokes=true;this.shouldDrawInteractionState=true}var T=t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled?t.keyboardNavConfig.disabled:false;var N=i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled?i.keyboardNavConfig.disabled:false;var D=t&&t.elementsAreInterface?t.elementsAreInterface:false;var E=i&&i.elementsAreInterface?i.elementsAreInterface:false;if(T!==N||D!==E){this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}if(D!==E){this.shouldDrawInteractionState=true}};t.prototype.localizationWatcher=function(t,i){this.shouldValidate=true;var s=t&&t.language?t.language:false;var e=i&&i.language?i.language:false;if(s!==e){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}var r=t&&t.numeralLocale?t.numeralLocale:false;var n=i&&i.numeralLocale?i.numeralLocale:false;if(r!==n){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}};t.prototype.annotationsWatcher=function(t,i){this.shouldValidate=true;this.shouldUpdateAnnotations=true;this.shouldSetAnnotationAccessibility=true};t.prototype.idWatcher=function(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")};t.prototype.suppressWatcher=function(t,i){this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldValidate=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true};t.prototype.componentWillLoad=function(){var t=this;var i=this.uniqueID||"circle-pack-"+u();this.initialLoadEvent.emit({chartID:i});return new Promise((function(s){t.duration=0;t.chartID=i;t.circlePackingEl.id=t.chartID;t.setLocalizationConfig();t.setTagLevels();t.validateInteractionKeys();t.setTableData();t.setLayoutData();t.restructureData();t.shouldValidateAccessibilityProps();t.shouldValidateLocalizationProps();t.setColors();s("component will load")}))};t.prototype.componentWillUpdate=function(){return new Promise((function(t){t("component will update")}))};t.prototype.componentDidLoad=function(){var t=this;return new Promise((function(i){t.renderRootElements();t.setTooltipInitialStyle();t.setChartDescriptionWrapper();t.setChartAccessibilityTitle();t.setChartAccessibilitySubtitle();t.setChartAccessibilityLongDescription();t.setChartAccessibilityExecutiveSummary();t.setChartAccessibilityPurpose();t.setChartAccessibilityContext();t.setChartAccessibilityStatisticalNotes();t.setChartAccessibilityStructureNotes();t.setParentSVGAccessibility();t.prepareChartForDrawing();t.reSetRoot();t.setTextures();t.setSubTitleElements();t.setStrokes();t.setTextStrokes();t.updateDisplayDepth();t.enterUpdateExitCircles(t.circleG,t.filterData(t.currentDepth));var s=t.getZoomTarget();t.drawZoomChildren(s);t.setChartCountAccessibility();t.setGeometryAccessibilityAttributes();t.setGeometryAriaLabels();t.addStrokeUnder();t.zoom(s);t.drawAnnotations();t.setAnnotationAccessibility();t.onChangeHandler();kt(t.root.node(),t.circleG.node(),true);i("component did load")})).then((function(){return t.initialLoadEndEvent.emit({chartID:t.chartID})}))};t.prototype.componentDidUpdate=function(){var t=this;return new Promise((function(i){t.duration=!t.animationConfig||!t.animationConfig.disabled?750:0;t.prepareChartForDrawing();if(t.shouldResetRoot){t.reSetRoot();t.shouldResetRoot=false}if(t.shouldSetColors){t.setColors();t.shouldSetColors=false}if(t.shouldSetTextures){t.setTextures();t.shouldSetTextures=false}if(t.shouldSetStrokes){t.setStrokes();t.shouldSetStrokes=false}if(t.shouldSetTextStrokes){t.setTextStrokes();t.shouldSetTextStrokes=false}if(t.shouldSetIDs){t.setIDs();t.shouldSetIDs=false}if(t.shouldUpdateDescriptionWrapper){t.setChartDescriptionWrapper();t.shouldUpdateDescriptionWrapper=false}if(t.shouldSetChartAccessibilityCount){t.setChartCountAccessibility();t.shouldSetChartAccessibilityCount=false}if(t.shouldSetChartAccessibilityTitle){t.setChartAccessibilityTitle();t.shouldSetChartAccessibilityTitle=false}if(t.shouldSetChartAccessibilitySubtitle){t.setChartAccessibilitySubtitle();t.shouldSetChartAccessibilitySubtitle=false}if(t.shouldSetChartAccessibilityLongDescription){t.setChartAccessibilityLongDescription();t.shouldSetChartAccessibilityLongDescription=false}if(t.shouldSetChartAccessibilityExecutiveSummary){t.setChartAccessibilityExecutiveSummary();t.shouldSetChartAccessibilityExecutiveSummary=false}if(t.shouldSetChartAccessibilityPurpose){t.setChartAccessibilityPurpose();t.shouldSetChartAccessibilityPurpose=false}if(t.shouldSetChartAccessibilityContext){t.setChartAccessibilityContext();t.shouldSetChartAccessibilityContext=false}if(t.shouldSetChartAccessibilityStatisticalNotes){t.setChartAccessibilityStatisticalNotes();t.shouldSetChartAccessibilityStatisticalNotes=false}if(t.shouldSetChartAccessibilityStructureNotes){t.setChartAccessibilityStructureNotes();t.shouldSetChartAccessibilityStructureNotes=false}if(t.shouldSetParentSVGAccessibility){t.setParentSVGAccessibility();t.shouldSetParentSVGAccessibility=false}if(t.shouldUpdateDisplayDepth){t.updateDisplayDepth();t.shouldUpdateDisplayDepth=false}if(t.shouldZoom){var s=t.getZoomTarget();t.drawZoomChildren(s);t.zoom(s);t.shouldZoom=false}else if(t.shouldUpdateLabels){var s=t.getZoomTarget();if(s.children&&s.children.length){t.setLabelSelections(s.children)}t.shouldUpdateLabels=false}if(t.shouldAddStrokeUnder){t.addStrokeUnder();t.shouldAddStrokeUnder=false}if(t.shouldSetGeometryAccessibilityAttributes){t.setGeometryAccessibilityAttributes();t.shouldSetGeometryAccessibilityAttributes=false}if(t.shouldSetGeometryAriaLabels){t.setGeometryAriaLabels();t.shouldSetGeometryAriaLabels=false}if(t.shouldBindInteractivity){t.bindInteractivity();t.shouldBindInteractivity=false}if(t.shouldDrawInteractionState){t.updateInteractionState();t.shouldDrawInteractionState=false}if(t.shouldSetSubTitle){t.setSubTitleElements();t.shouldSetSubTitle=false}if(t.shouldUpdateCursor){t.updateCursor();t.shouldUpdateCursor=false}if(t.shouldUpdateAnnotations){t.drawAnnotations();t.shouldUpdateAnnotations=false}if(t.shouldSetAnnotationAccessibility){t.setAnnotationAccessibility();t.shouldSetAnnotationAccessibility=false}t.onChangeHandler();i("component did update")})).then((function(){return t.drawEndEvent.emit({chartID:t.chartID})}))};t.prototype.shouldValidateLocalizationProps=function(){var t=ct();var i=t.i18Next.language;var s=t.i18Next.getResourceBundle(i);var e=t.numeral.localeData();if(this.shouldValidateLocalization&&!this.localization.skipValidation){this.shouldValidateLocalization=false;ti(this.chartID,Object.assign(Object.assign({},this.localization),{language:s,numeralLocale:e}))}};t.prototype.shouldValidateAccessibilityProps=function(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=false;Zt(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:!this.suppressEvents?this.clickEvent.emit:undefined}})}};t.prototype.setTableData=function(){var t=Xt(this,_t,"circle-packing");this.tableData=Ft(this.data,t);this.tableColumns=Object.keys(t)};t.prototype.setLayoutData=function(){this.padding=typeof this.padding==="string"?qt(this.padding):this.padding;this.innerHeight=this.height-this.margin.top-this.margin.bottom;this.innerWidth=this.width-this.margin.left-this.margin.right;this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom;this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right};t.prototype.restructureData=function(){var t=this;this.diameter=Math.min(this.innerPaddedWidth,this.innerPaddedHeight);this.holder=at().id((function(i){return i[t.nodeAccessor]})).parentId((function(i){return i[t.parentAccessor]}))(this.data);this.rootCircle=N(this.holder).sum((function(i){return i.data[t.sizeAccessor]||1})).sort((function(t,i){return i.data.value-t.data.value}));this.nodes=Y().size([this.diameter-this.circlePadding,this.diameter-this.circlePadding]).padding(this.circlePadding)(this.rootCircle).descendants();this.innerDataDepth=this.dataDepth?Math.min(o(this.nodes,(function(t){return t.depth})),this.dataDepth):o(this.nodes,(function(t){return t.depth}));this.nodes=this.nodes.filter((function(i){return!(i.depth>t.innerDataDepth)}))};t.prototype.getLanguageString=function(){return lt(this.localization)};t.prototype.setLocalizationConfig=function(){ft(this.localization)};t.prototype.validateInteractionKeys=function(){this.innerInteractionKeys=!this.interactionKeys||this.interactionKeys&&this.interactionKeys.length===0?[this.nodeAccessor]:__spreadArray([],this.interactionKeys,true)};t.prototype.prepareChartForDrawing=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";var i=this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).data()[0]:this.rootCircle;this.view=!this.view?[i.x,i.y,i.r*2]:this.view;this.zoomRatio=!this.zoomRatio?this.diameter/this.view[2]:this.zoomRatio;this.currentDepth=i.depth};t.prototype.renderRootElements=function(){this.svg=h(this.circlePackingEl).select(".visa-viz-circle-packing-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height).attr("data-testid","root-svg");this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID).attr("data-testid","margin-container");this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID).attr("data-testid","padding-container");this.circleG=this.rootG.append("g").attr("class","circle-pack-group").attr("data-testid","circle-group");this.textG=this.rootG.append("g").attr("class","circle-pack-text-group").attr("data-testid","dataLabel-group");this.subTitleG=h(this.circlePackingEl).select(".circle-packing-sub-title");this.tooltipG=h(this.circlePackingEl).select(".circle-packing-tooltip")};t.prototype.reSetRoot=function(){var t=si({selection:this.svg,duration:this.duration,namespace:"root_reset"});t.attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height);var i=si({selection:this.root,duration:this.duration,namespace:"root_reset"});i.attr("transform","translate(".concat(this.diameter/2+this.margin.left,", ").concat(this.diameter/2+this.margin.top,")"));var s=si({selection:this.rootG,duration:this.duration,namespace:"root_reset"});s.attr("transform","translate(".concat(this.padding.left,", ").concat(this.padding.top,")"));if(typeof this.filter!=="undefined"){this.enterUpdateExitCircles(this.circleG,this.filterData(0))}St(this.chartID,this.width)};t.prototype.setGlobalSelections=function(){this.circle=this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)")};t.prototype.enterUpdateExitCircles=function(t,i){var s=i[0].depth;var e=t.selectAll(".g-level-"+s).data(i,(function(t){return t.data.id}));this.enterCircle=e.enter().append("g");this.enterSize+=this.enterCircle.size();this.exitCircle=e.exit();this.enterCircles(s);this.exitCircles(this.exitCircle,true);this.updateParentCircle=e.merge(this.enterCircle);this.updateParentCircle.order();this.checkRecursion(s)};t.prototype.enterCircles=function(t){var i=this;this.enterCircle.attr("class","g-level-"+t).attr("id",(function(t){return"circle-in-pack-"+i.generateValidId(t.data.id)}));this.enterCircle.append("circle").attr("filter",this.setCircleFilter).classed("node node-level-"+t,true).classed("node--root",(function(t,i,s){var e=h(s[i].parentNode).datum();return!e.parent})).on("mouseover",!this.suppressEvents?function(t,s,e){var r=h(e[s].parentNode).datum();i.onHoverHandler(r,e[s])}:null).on("mouseout",!this.suppressEvents?function(){i.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(t,s,e){var r=h(e[s].parentNode).datum();if(!i.zooming){i.clickEvent.emit({data:r.data.data,target:e[s]})}}:null).attr("fill",this.setCircleStyle).attr("opacity",(function(t,s,e){var r=h(e[s].parentNode).datum();var n=r.data.data;return Ct(n,1,i.hoverOpacity,i.hoverHighlight,i.clickHighlight,i.innerInteractionKeys)})).each((function(t,s,e){gt(e[s]);yt({node:e[s],geomType:"node",includeKeyNames:i.accessibility.includeDataKeyNames,dataKeys:Xt(i,_t,"circle-packing"),dataKeyNames:i.dataKeyNames,recursive:true,groupName:"node",uniqueID:i.chartID});bt({node:e[s],uniqueID:i.chartID});var r=h(e[s].parentNode).datum();var n=Ct(r,true,false,"",i.clickHighlight,i.innerInteractionKeys);n=i.clickHighlight&&i.clickHighlight.length?n:false;var a=i.accessibility.elementsAreInterface;zt(e[s],n,a)})).attr("data-testid","circle").attr("data-id",(function(t,s,e){var r=h(e[s].parentNode).datum();var n=r.data.data;return"circle-".concat(n[i.parentAccessor],"-").concat(n[i.nodeAccessor])})).attr("cursor",!this.suppressEvents?this.cursor:null).attr("transform",(function(t){return"translate("+Ut((t.x-i.view[0])*i.zoomRatio,4)+","+Ut((t.y-i.view[1])*i.zoomRatio,4)+")"})).attr("r",0)};t.prototype.exitCircles=function(t,i){if(t.size()){this.exitSize+=t.size();if(i){this.exitSize+=t.selectAll("g").size()}var s=Ot(this.rootG.node());t.remove();this.setChartCountAccessibility();this.setGeometryAriaLabels();Mt({parentGNode:this.rootG.node(),focusDidExist:s,recursive:true})}};t.prototype.checkRecursion=function(t){var i=this;this.updateParentCircle.each((function(s,e,r){var n=i.currentDepth+i.innerDisplayDepth;var a=0;if(s.depth+1<=n){a=t+1}if(a&&s.children&&s.children.length){i.enterUpdateExitCircles(h(r[e]),s.children)}else{i.exitCircles(h(r[e]).selectAll("g"),false)}}))};t.prototype.setLabelSelections=function(t){var i=this.textG.selectAll("text").data(t,(function(t){return(t.data||{}).id}));this.enterText=i.enter().append("text");this.updateText=i.merge(this.enterText);this.exitText=i.exit().remove();this.enterLabels();this.drawLabels()};t.prototype.enterLabels=function(){var t=this;this.enterText.attr("filter",this.textFilter).attr("class","label circle-packing-dataLabel").attr("cursor",!this.suppressEvents?this.cursor:null).attr("data-testid","dataLabel").attr("data-x",(function(i){return Ut((i.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(i){return Ut((i.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).attr("x",(function(i){return Ut((i.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(i){return Ut((i.y-t.view[1])*t.zoomRatio,4)})).attr("text-anchor","middle")};t.prototype.drawLabels=function(){var t=this;this.updateText.attr("opacity",(function(i){return t.dataLabel.visible?1:0})).text((function(i){return t.dataLabel.labelAccessor?i.data.data[t.dataLabel.labelAccessor]:i.data.data[t.nodeAccessor]}));if(!this.shouldZoom&&this.shouldUpdateLabels)this.placeLabels()};t.prototype.placeLabels=function(){var t=this;var i=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;var s=this.updateText.classed("moving",(function(i,s,e){var r=+h(e[s]).attr("data-x");var n=+h(e[s]).attr("data-y");var a=Ut((i.x-t.view[0])*t.zoomRatio,4);var u=Ut((i.y-t.view[1])*t.zoomRatio,4);return r!==a||n!==u})).attr("data-x",(function(i){return Ut((i.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(i){return Ut((i.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).style("visibility",(function(i,s,e){return t.dataLabel.placement==="auto"||t.dataLabel.collisionHideOnly?h(e[s]).style("visibility"):null})).attr("filter",null).transition("place").duration(this.duration);var e={all:{validPositions:["middle","top","bottom","left","right","bottom-right","bottom-left","top-left","top-right"],offsets:[1,1,2,4,4,1,1,1,1]},centroid:{validPositions:["middle"],offsets:[1]},top:{validPositions:["top","top-left","top-right"],offsets:[1,1,1]},middle:{validPositions:["middle","left","right"],offsets:[1,4,4]},bottom:{validPositions:["bottom","bottom-left","bottom-right"],offsets:[2,1,1]},right:{validPositions:["right","top-right","bottom-right"],offsets:[4,1,1]},left:{validPositions:["left","top-left","bottom-left"],offsets:[4,1,1]}};var r=this.dataLabel&&this.dataLabel.collisionPlacement;var n=i?["middle"]:r&&e[r]?e[r].validPositions:e["all"].validPositions;var a=i?[1]:r&&e[r]?e[r].offsets:e["all"].offsets;if(this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly)){this.bitmaps=ei({labelSelection:s,avoidMarks:[],validPositions:n,offsets:a,accessors:[this.parentAccessor,this.nodeAccessor],size:[Ut(this.innerPaddedWidth),Ut(this.innerPaddedHeight)],hideOnly:this.dataLabel.visible&&i});if(i){s.attr("x",(function(i){return Ut((i.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(i){return Ut((i.y-t.view[1])*t.zoomRatio,4)}))}}else{s.attr("x",(function(i){return Ut((i.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(i){return Ut((i.y-t.view[1])*t.zoomRatio,4)}))}s.call(Qt,(function(){t.updateText.classed("moving",false);setTimeout((function(){t.addStrokeUnder()}),0)}))};t.prototype.addStrokeUnder=function(){this.updateText.attr("filter",this.textFilter)};t.prototype.setTextStrokes=function(){this.textFilter=vt({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.filter=vt({root:this.svg.node(),id:this.chartID,color:"#ffffff",strokeSizeOverride:1})};t.prototype.bindInteractivity=function(){var t=this;this.circle.on("mouseover",!this.suppressEvents?function(i,s,e){var r=h(e[s].parentNode).datum();t.onHoverHandler(r,e[s])}:null).on("mouseout",!this.suppressEvents?function(){t.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(i,s,e){var r=h(e[s].parentNode).datum();if(!t.zooming){t.clickEvent.emit({data:r.data.data,target:e[s]})}}:null)};t.prototype.drawAnnotations=function(){jt({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})};t.prototype.setAnnotationAccessibility=function(){At(this.getLanguageString(),this.circlePackingEl,this.annotations,undefined)};t.prototype.setSubTitleElements=function(){ri({root:this.subTitleG,subTitle:this.subTitle})};t.prototype.setColors=function(){this.preparedColors=this.colors?Bt(this.colors):Vt(this.colorPalette,this.innerDataDepth+1)};t.prototype.setTextures=function(){var t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6){this.colorArr=this.preparedColors}else{var i=pt({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(i):i}};t.prototype.setStrokes=function(){var t=this;this.strokes=[];this.preparedColors.forEach((function(i){t.strokes.push(dt(i))}))};t.prototype.updateDisplayDepth=function(){var t=this;this.innerDisplayDepth=this.displayDepth?Math.min(o(this.nodes,(function(t){return t.depth})),this.displayDepth):o(this.nodes,(function(t){return t.depth}));if(this.circleG){this.circleG.selectAll("g").each((function(i,s,e){if(i.depth>t.innerDisplayDepth){t.exitSize++;t.exitSize+=h(e[s]).selectAll("g").size();h(e[s]).remove()}}))}};t.prototype.updateCursor=function(){this.circle.attr("cursor",!this.suppressEvents?this.cursor:null)};t.prototype.updateInteractionState=function(){var t=this;this.circle.attr("fill",this.setCircleStyle).attr("filter",this.setCircleFilter).attr("opacity",(function(i,s,e){var r=h(e[s].parentNode).datum();var n=r.data.data;return Ct(n,1,t.hoverOpacity,t.hoverHighlight,t.clickHighlight,t.innerInteractionKeys)})).each((function(i,s,e){var r=h(e[s].parentNode).datum();var n=Ct(r,true,false,"",t.clickHighlight,t.innerInteractionKeys);n=t.clickHighlight&&t.clickHighlight.length?n:false;var a=t.accessibility.elementsAreInterface;zt(e[s],n,a)}));if(!this.zooming){Mt({parentGNode:this.rootG.node(),recursive:true})}};t.prototype.drawZoomChildren=function(t){if(t.children&&t.children.length){var i=this.generateValidId(t.data.id);this.enterUpdateExitCircles(this.rootG.select("#circle-in-pack-"+i),t.children);this.setGlobalSelections();this.setLabelSelections(t.children)}else if(t){this.setGlobalSelections();this.setLabelSelections([t])}};t.prototype.getZoomTarget=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";return this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).datum():this.rootCircle};t.prototype.zoom=function(t){var i=this;this.zooming=true;this.view=[t.x,t.y,t.r*2];this.zoomRatio=this.diameter/this.view[2];this.circle.classed("moving",(function(t,s,e){var r=h(e[s].parentNode).datum();var n=+h(e[s]).attr("data-cx");var a=+h(e[s]).attr("data-cy");var u=+h(e[s]).attr("r");var o=Ut((r.x-i.view[0])*i.zoomRatio,4);var f=Ut((r.y-i.view[1])*i.zoomRatio,4);var c=r.r*i.zoomRatio;return u!==c||n!==o||a!==f})).attr("data-cx",(function(t,s,e){var r=h(e[s].parentNode).datum();return Ut((r.x-i.view[0])*i.zoomRatio,4)})).attr("data-cy",(function(t,s,e){var r=h(e[s].parentNode).datum();return Ut((r.y-i.view[1])*i.zoomRatio,4)})).attr("data-r",(function(t,s,e){var r=h(e[s].parentNode).datum();return r.r*i.zoomRatio})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top);var s=this.circle.filter(".moving").attr("filter",null).transition("zoom").duration(this.duration).attr("transform",(function(t,s,e){var r=h(e[s].parentNode).datum();return"translate("+Ut((r.x-i.view[0])*i.zoomRatio,4)+","+Ut((r.y-i.view[1])*i.zoomRatio,4)+")"})).attr("r",(function(t,s,e){var r=h(e[s].parentNode).datum();return r.r*i.zoomRatio}));var e=function(){i.zooming=false;i.circle.classed("moving",false);setTimeout((function(){i.circle.attr("filter",i.setCircleFilter)}),0);Mt({parentGNode:i.rootG.node(),recursive:true});i.transitionEndEvent.emit({chartID:i.chartID})};if(this.duration&&s.size()>0){s.attrTween("x",(function(t,s,e){var r=h(e[s]).classed("vcl-accessibility-focus-source");return function(){if(r){Mt({parentGNode:i.rootG.node(),recursive:true})}return 0}})).call(Qt,e)}else{e()}this.placeLabels()};t.prototype.onHoverHandler=function(t,i){Rt(this.chartID,true);this.hoverEvent.emit({data:t.data.data,target:i});if(this.showTooltip){this.eventsTooltip({data:t.data.data,evt:a,isToShow:true})}};t.prototype.onMouseOutHandler=function(){Rt(this.chartID,false);this.mouseOutEvent.emit();if(this.showTooltip){this.eventsTooltip({isToShow:false})}};t.prototype.setTooltipInitialStyle=function(){Jt(this.tooltipG)};t.prototype.eventsTooltip=function(t){var i=t.data,s=t.evt,e=t.isToShow;Lt({root:this.tooltipG,data:i,event:s,isToShow:e,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,ordinalAccessor:this.nodeAccessor,groupAccessor:this.parentAccessor,valueAccessor:this.sizeAccessor,chartType:"circle-packing"})};t.prototype.setTagLevels=function(){this.topLevel=ii(this.highestHeadingLevel);this.bottomLevel=ii(this.highestHeadingLevel,3)};t.prototype.setChartDescriptionWrapper=function(){mt({language:this.getLanguageString(),rootEle:this.circlePackingEl,title:this.accessibility.title||this.mainTitle,chartTag:"circle-packing",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,recursive:true,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton});this.shouldRedrawWrapper=false};t.prototype.setParentSVGAccessibility=function(){wt({chartTag:"circle-packing",language:this.getLanguageString(),node:this.svg.node(),title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Xt(this,_t,"circle-packing"),dataKeyNames:this.dataKeyNames,groupAccessor:this.parentAccessor,groupName:"node",recursive:true,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})};t.prototype.setGeometryAccessibilityAttributes=function(){this.rootG.selectAll(".node").each((function(t,i,s){gt(s[i])}))};t.prototype.setGeometryAriaLabels=function(){var t=this;var i=Xt(this,_t,"circle-packing");this.rootG.selectAll(".node").each((function(s,e,r){yt({chartTag:"circle-packing",langauge:t.getLanguageString(),node:r[e],geomType:"node",includeKeyNames:t.accessibility.includeDataKeyNames,dataKeys:i,dataKeyNames:t.dataKeyNames,recursive:true,groupName:"node",uniqueID:t.chartID,disableKeyNav:t.suppressEvents&&t.accessibility.elementsAreInterface===false&&t.accessibility.keyboardNavConfig&&t.accessibility.keyboardNavConfig.disabled});bt({node:r[e],uniqueID:t.chartID})}))};t.prototype.setChartAccessibilityTitle=function(){xt(this.getLanguageString(),this.circlePackingEl,this.accessibility.title||this.mainTitle)};t.prototype.setChartAccessibilitySubtitle=function(){Wt(this.getLanguageString(),this.circlePackingEl,this.subTitle)};t.prototype.setChartAccessibilityLongDescription=function(){Tt(this.getLanguageString(),this.circlePackingEl,this.accessibility.longDescription)};t.prototype.setChartAccessibilityExecutiveSummary=function(){Nt(this.getLanguageString(),this.circlePackingEl,this.accessibility.executiveSummary)};t.prototype.setChartAccessibilityPurpose=function(){Dt(this.getLanguageString(),this.circlePackingEl,this.accessibility.purpose)};t.prototype.setChartAccessibilityContext=function(){Et(this.getLanguageString(),this.circlePackingEl,this.accessibility.contextExplanation)};t.prototype.setChartAccessibilityStatisticalNotes=function(){Pt(this.getLanguageString(),this.circlePackingEl,this.accessibility.statisticalNotes)};t.prototype.setChartCountAccessibility=function(){It({rootEle:this.circlePackingEl,parentGNode:this.circleG.node(),chartTag:"circle-packing",geomType:"node",groupName:"node",recursive:true})};t.prototype.setChartAccessibilityStructureNotes=function(){Kt(this.getLanguageString(),this.circlePackingEl,this.accessibility.structureNotes)};t.prototype.onChangeHandler=function(){if(this.accessibility&&typeof this.accessibility.onChangeFunc==="function"){var t={updated:this.updated,added:this.enterSize,removed:this.exitSize};this.accessibility.onChangeFunc(t)}this.updated=false;this.enterSize=0;this.exitSize=0};t.prototype.filterData=function(t){return this.nodes.filter((function(i){if(i.depth===t){return true}return false}))};t.prototype.render=function(){this.drawStartEvent.emit({chartID:this.chartID});this.init();if(this.shouldSetLocalizationConfig){this.setLocalizationConfig();this.shouldSetLocalizationConfig=false}if(this.shouldSetTagLevels){this.setTagLevels();this.shouldSetTagLevels=false}if(this.shouldValidateInteractionKeys){this.validateInteractionKeys();this.shouldValidateInteractionKeys=false}if(this.shouldUpdateTableData){this.setTableData();this.shouldUpdateTableData=false}if(this.shouldValidate){this.shouldValidateAccessibilityProps();this.shouldValidateLocalizationProps();this.shouldValidate=false}if(this.shouldUpdateLayout){this.setLayoutData();this.shouldUpdateLayout=false}if(this.shouldUpdateData){this.restructureData();this.shouldUpdateData=false}return e("div",{key:"79ec0386c06e1e0c360cef9d80eafe35b5b69a52",class:"o-layout","data-testid":"outer-layout"},e("div",{key:"7866aa053778a794af1ca4d387ec727e42f6da62",class:"o-layout--chart","data-testid":"layout-chart"},e(this.topLevel,{key:"638cea8cdfcd360aa6fdb50791f169cba9a3902b","data-testid":"main-title"},this.mainTitle),e(this.bottomLevel,{key:"bd19899287b8cf655b1537874f22f7a46f7a320b",class:"visa-ui-text--instructions circle-packing-sub-title vcl-sub-title","data-testid":"sub-title"}),e("keyboard-instructions",{key:"3734584d4822584f3dd046d2dd75aebba16d17e6",uniqueID:this.chartID,geomType:"node",groupName:"node collection",language:this.getLanguageString(),chartTag:"circle-packing",width:this.width-(this.margin?this.margin.right||0:0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:true,disabled:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),e("div",{key:"c8c32a11274566ca897d7e1c312af6fab62106d4",class:"visa-viz-circle-packing-container","data-testid":"chart-container"}),e("div",{key:"39aa91db80095f8ad5f9ae70c2a05bf74ff7da88",class:"circle-packing-tooltip vcl-tooltip","data-testid":"tooltip-container",style:{display:this.showTooltip?"block":"none"}}),e("data-table",{key:"baa297fb4e9e490753f7e952642a663950db210b",uniqueID:this.chartID,language:this.getLanguageString(),unitTest:true,isCompact:true,tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton})))};t.prototype.init=function(){var t=Object.keys(c);var i=0;var s={showTooltip:{exception:false},circlePadding:{exception:0},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(i=0;i<t.length;i++){var e=!s[t[i]]?false:this[t[i]]===s[t[i]].exception;if(!(this[t[i]]||e)&&!(c[t[i]]===this[t[i]])){this[t[i]]=c[t[i]]}}};Object.defineProperty(t.prototype,"circlePackingEl",{get:function(){return r(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{data:["dataWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],parentAccessor:["clusterWatcher"],nodeAccessor:["nodeWatcher"],sizeAccessor:["sizeWatcher"],height:["heightWatcher"],width:["heightWatcher"],padding:["heightWatcher"],margin:["heightWatcher"],dataDepth:["dataDepthWatcher"],displayDepth:["displayDepthWatcher"],circlePadding:["circlePaddingWatcher"],colors:["colorsWatcher"],colorPalette:["colorsWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],hoverOpacity:["hoverOpacityWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],zoomToNode:["zoomWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],dataLabel:["labelWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],annotations:["annotationsWatcher"],uniqueID:["idWatcher"],suppressEvents:["suppressWatcher"]}},enumerable:false,configurable:true});return t}());window["VisaChartsLibOSSLicenses"]=$t();ni.style=ot}}}));
//# sourceMappingURL=p-223cad10.system.entry.js.map