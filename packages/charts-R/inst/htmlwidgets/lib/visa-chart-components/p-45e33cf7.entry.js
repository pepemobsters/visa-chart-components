/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as e}from"./p-b0ab226b.js";import{U as h,s as r,e as a}from"./p-5fcd3c02.js";import{v as n}from"./p-b5f7528a.js";import{m as o}from"./p-e1d72334.js";const{propDefaultValues:c}=h;class l{}l.mainTitle="Circle Packing Title";l.subTitle=c.subTitle.text;l.height=400;l.width=400;l.circlePadding=5;l.margin={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};l.padding={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};l.localization=c.localization;l.dataDepth=5;l.displayDepth=2;l.parentAccessor="parentNode";l.nodeAccessor="childNode";l.sizeAccessor="value";l.colorPalette=c.colorPaletteSequentialGrey;l.dataLabel=c.dataLabelCenter;l.hoverStyle=c.hoverStyle;l.clickStyle=c.clickStyle;l.hoverOpacity=c.hoverOpacity;l.cursor=c.cursor;l.interactionKeys=c.interactionKeys;l.highestHeadingLevel=c.highestHeadingLevel;l.annotations=c.annotations;l.accessibility=c.accessibility;l.animationConfig=c.animationConfig;l.tooltipLabel=c.tooltipLabel;l.showTooltip=c.showTooltip;l.clickHighlight=c.clickHighlight;l.suppressEvents=c.suppressEvents;function u(t){var i=0,s=t.children,e=s&&s.length;if(!e)i=1;else while(--e>=0)i+=s[e].value;t.value=i}function f(){return this.eachAfter(u)}function d(t){var i=this,s,e=[i],h,r,a;do{s=e.reverse(),e=[];while(i=s.pop()){t(i),h=i.children;if(h)for(r=0,a=h.length;r<a;++r){e.push(h[r])}}}while(e.length);return this}function p(t){var i=this,s=[i],e,h;while(i=s.pop()){t(i),e=i.children;if(e)for(h=e.length-1;h>=0;--h){s.push(e[h])}}return this}function g(t){var i=this,s=[i],e=[],h,r,a;while(i=s.pop()){e.push(i),h=i.children;if(h)for(r=0,a=h.length;r<a;++r){s.push(h[r])}}while(i=e.pop()){t(i)}return this}function v(t){return this.eachAfter((function(i){var s=+t(i.data)||0,e=i.children,h=e&&e.length;while(--h>=0)s+=e[h].value;i.value=s}))}function m(t){return this.eachBefore((function(i){if(i.children){i.children.sort(t)}}))}function y(t){var i=this,s=b(i,t),e=[i];while(i!==s){i=i.parent;e.push(i)}var h=e.length;while(t!==s){e.splice(h,0,t);t=t.parent}return e}function b(t,i){if(t===i)return t;var s=t.ancestors(),e=i.ancestors(),h=null;t=s.pop();i=e.pop();while(t===i){h=t;t=s.pop();i=e.pop()}return h}function w(){var t=this,i=[t];while(t=t.parent){i.push(t)}return i}function k(){var t=[];this.each((function(i){t.push(i)}));return t}function W(){var t=[];this.eachBefore((function(i){if(!i.children){t.push(i)}}));return t}function T(){var t=this,i=[];t.each((function(s){if(s!==t){i.push({source:s.parent,target:s})}}));return i}function A(t,i){var s=new E(t),e=+t.value&&(s.value=t.value),h,r=[s],a,n,o,c;if(i==null)i=D;while(h=r.pop()){if(e)h.value=+h.data.value;if((n=i(h.data))&&(c=n.length)){h.children=new Array(c);for(o=c-1;o>=0;--o){r.push(a=h.children[o]=new E(n[o]));a.parent=h;a.depth=h.depth+1}}}return s.eachBefore(C)}function x(){return A(this).eachBefore(S)}function D(t){return t.children}function S(t){t.data=t.data.data}function C(t){var i=0;do{t.height=i}while((t=t.parent)&&t.height<++i)}function E(t){this.data=t;this.depth=this.height=0;this.parent=null}E.prototype=A.prototype={constructor:E,count:f,each:d,eachAfter:g,eachBefore:p,sum:v,sort:m,path:y,ancestors:w,descendants:k,leaves:W,links:T,copy:x};var L=Array.prototype.slice;function N(t){var i=t.length,s,e;while(i){e=Math.random()*i--|0;s=t[i];t[i]=t[e];t[e]=s}return t}function P(t){var i=0,s=(t=N(L.call(t))).length,e=[],h,r;while(i<s){h=t[i];if(r&&K(r,h))++i;else r=O(e=I(e,h)),i=0}return r}function I(t,i){var s,e;if(M(i,t))return[i];for(s=0;s<t.length;++s){if(z(i,t[s])&&M(H(t[s],i),t)){return[t[s],i]}}for(s=0;s<t.length-1;++s){for(e=s+1;e<t.length;++e){if(z(H(t[s],t[e]),i)&&z(H(t[s],i),t[e])&&z(H(t[e],i),t[s])&&M(q(t[s],t[e],i),t)){return[t[s],t[e],i]}}}throw new Error}function z(t,i){var s=t.r-i.r,e=i.x-t.x,h=i.y-t.y;return s<0||s*s<e*e+h*h}function K(t,i){var s=t.r-i.r+1e-6,e=i.x-t.x,h=i.y-t.y;return s>0&&s*s>e*e+h*h}function M(t,i){for(var s=0;s<i.length;++s){if(!K(t,i[s])){return false}}return true}function O(t){switch(t.length){case 1:return G(t[0]);case 2:return H(t[0],t[1]);case 3:return q(t[0],t[1],t[2])}}function G(t){return{x:t.x,y:t.y,r:t.r}}function H(t,i){var s=t.x,e=t.y,h=t.r,r=i.x,a=i.y,n=i.r,o=r-s,c=a-e,l=n-h,u=Math.sqrt(o*o+c*c);return{x:(s+r+o/u*l)/2,y:(e+a+c/u*l)/2,r:(u+h+n)/2}}function q(t,i,s){var e=t.x,h=t.y,r=t.r,a=i.x,n=i.y,o=i.r,c=s.x,l=s.y,u=s.r,f=e-a,d=e-c,p=h-n,g=h-l,v=o-r,m=u-r,y=e*e+h*h-r*r,b=y-a*a-n*n+o*o,w=y-c*c-l*l+u*u,k=d*p-f*g,W=(p*w-g*b)/(k*2)-e,T=(g*v-p*m)/k,A=(d*b-f*w)/(k*2)-h,x=(f*m-d*v)/k,D=T*T+x*x-1,S=2*(r+W*T+A*x),C=W*W+A*A-r*r,E=-(D?(S+Math.sqrt(S*S-4*D*C))/(2*D):C/S);return{x:e+W+T*E,y:h+A+x*E,r:E}}function j(t,i,s){var e=t.x-i.x,h,r,a=t.y-i.y,n,o,c=e*e+a*a;if(c){r=i.r+s.r,r*=r;o=t.r+s.r,o*=o;if(r>o){h=(c+o-r)/(2*c);n=Math.sqrt(Math.max(0,o/c-h*h));s.x=t.x-h*e-n*a;s.y=t.y-h*a+n*e}else{h=(c+r-o)/(2*c);n=Math.sqrt(Math.max(0,r/c-h*h));s.x=i.x+h*e-n*a;s.y=i.y+h*a+n*e}}else{s.x=i.x+s.r;s.y=i.y}}function $(t,i){var s=t.r+i.r-1e-6,e=i.x-t.x,h=i.y-t.y;return s>0&&s*s>e*e+h*h}function V(t){var i=t._,s=t.next._,e=i.r+s.r,h=(i.x*s.r+s.x*i.r)/e,r=(i.y*s.r+s.y*i.r)/e;return h*h+r*r}function F(t){this._=t;this.next=null;this.previous=null}function R(t){if(!(h=t.length))return 0;var i,s,e,h,r,a,n,o,c,l,u;i=t[0],i.x=0,i.y=0;if(!(h>1))return i.r;s=t[1],i.x=-s.r,s.x=i.r,s.y=0;if(!(h>2))return i.r+s.r;j(s,i,e=t[2]);i=new F(i),s=new F(s),e=new F(e);i.next=e.previous=s;s.next=i.previous=e;e.next=s.previous=i;t:for(n=3;n<h;++n){j(i._,s._,e=t[n]),e=new F(e);o=s.next,c=i.previous,l=s._.r,u=i._.r;do{if(l<=u){if($(o._,e._)){s=o,i.next=s,s.previous=i,--n;continue t}l+=o._.r,o=o.next}else{if($(c._,e._)){i=c,i.next=s,s.previous=i,--n;continue t}u+=c._.r,c=c.previous}}while(o!==c.next);e.previous=i,e.next=s,i.next=s.previous=s=e;r=V(i);while((e=e.next)!==s){if((a=V(e))<r){i=e,r=a}}s=i.next}i=[s._],e=s;while((e=e.next)!==s)i.push(e._);e=P(i);for(n=0;n<h;++n)i=t[n],i.x-=e.x,i.y-=e.y;return e.r}function U(t){return t==null?null:_(t)}function _(t){if(typeof t!=="function")throw new Error;return t}function B(){return 0}function Z(t){return function(){return t}}function J(t){return Math.sqrt(t.value)}function Q(){var t=null,i=1,s=1,e=B;function h(h){h.x=i/2,h.y=s/2;if(t){h.eachBefore(X(t)).eachAfter(Y(e,.5)).eachBefore(tt(1))}else{h.eachBefore(X(J)).eachAfter(Y(B,1)).eachAfter(Y(e,h.r/Math.min(i,s))).eachBefore(tt(Math.min(i,s)/(2*h.r)))}return h}h.radius=function(i){return arguments.length?(t=U(i),h):t};h.size=function(t){return arguments.length?(i=+t[0],s=+t[1],h):[i,s]};h.padding=function(t){return arguments.length?(e=typeof t==="function"?t:Z(+t),h):e};return h}function X(t){return function(i){if(!i.children){i.r=Math.max(0,+t(i)||0)}}}function Y(t,i){return function(s){if(e=s.children){var e,h,r=e.length,a=t(s)*i||0,n;if(a)for(h=0;h<r;++h)e[h].r+=a;n=R(e);if(a)for(h=0;h<r;++h)e[h].r-=a;s.r=n+a}}}function tt(t){return function(i){var s=i.parent;i.r*=t;if(s){i.x=s.x+t*i.x;i.y=s.y+t*i.y}}}var it="$",st={depth:-1},et={};function ht(t){return t.id}function rt(t){return t.parentId}function at(){var t=ht,i=rt;function s(s){var e,h,r=s.length,a,n,o,c=new Array(r),l,u,f={};for(h=0;h<r;++h){e=s[h],o=c[h]=new E(e);if((l=t(e,h,s))!=null&&(l+="")){u=it+(o.id=l);f[u]=u in f?et:o}}for(h=0;h<r;++h){o=c[h],l=i(s[h],h,s);if(l==null||!(l+="")){if(a)throw new Error("multiple roots");a=o}else{n=f[it+l];if(!n)throw new Error("missing: "+l);if(n===et)throw new Error("ambiguous: "+l);if(n.children)n.children.push(o);else n.children=[o];o.parent=n}}if(!a)throw new Error("no root");a.parent=st;a.eachBefore((function(t){t.depth=t.parent.depth+1;--r})).eachBefore(C);a.parent=null;if(r>0)throw new Error("cycle");return a}s.id=function(i){return arguments.length?(t=_(i),s):t};s.parentId=function(t){return arguments.length?(i=_(t),s):i};return s}const nt='.o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}circle-packing .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}circle-packing .annotations{pointer-events:none}circle-packing .annotations .handle{pointer-events:all}circle-packing .label{font:12px "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;text-anchor:middle}circle-packing .label,circle-packing .node--root{pointer-events:none}';const ot=nt;const{configLocalization:ct,getGlobalInstances:lt,getActiveLanguageString:ut,getContrastingStroke:ft,createTextStrokeFilter:dt,convertColorsToTextures:pt,initializeElementAccess:gt,initializeDescriptionRoot:vt,setElementFocusHandler:mt,setElementAccessID:yt,setAccessibilityController:bt,hideNonessentialGroups:wt,setAccessTitle:kt,setAccessSubtitle:Wt,setAccessLongDescription:Tt,setAccessExecutiveSummary:At,setAccessPurpose:xt,setAccessContext:Dt,setAccessStatistics:St,setAccessChartCounts:Ct,setAccessStructure:Et,setAccessAnnotation:Lt,retainAccessFocus:Nt,checkAccessFocus:Pt,setElementInteractionAccessState:It,drawTooltip:zt,setAccessibilityDescriptionWidth:Kt,annotate:Mt,getPadding:Ot,chartAccessors:Gt,checkInteraction:Ht,checkClicked:qt,checkHovered:jt,convertVisaColor:$t,getColors:Vt,getLicenses:Ft,getScopedData:Rt,initTooltipStyle:Ut,transitionEndAll:_t,overrideTitleTooltip:Bt,roundTo:Zt,scopeDataKeys:Jt,visaColors:Qt,validateAccessibilityProps:Xt,validateLocalizationProps:Yt,findTagLevel:ti,prepareRenderChange:ii,resolveLabelCollision:si,setSubTitle:ei}=h;const hi=class{constructor(s){t(this,s);this.clickEvent=i(this,"clickEvent",7);this.hoverEvent=i(this,"hoverEvent",7);this.mouseOutEvent=i(this,"mouseOutEvent",7);this.initialLoadEvent=i(this,"initialLoadEvent",7);this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7);this.drawStartEvent=i(this,"drawStartEvent",7);this.drawEndEvent=i(this,"drawEndEvent",7);this.transitionEndEvent=i(this,"transitionEndEvent",7);this.shouldValidateAccessibility=true;this.shouldValidateLocalization=true;this.currentDepth=0;this.zooming=false;this.timer=0;this.delay=200;this.prevent=false;this.updated=false;this.exitSize=0;this.enterSize=0;this.shouldZoom=false;this.shouldValidateInteractionKeys=false;this.shouldDrawInteractionState=false;this.shouldUpdateAnnotations=false;this.shouldResetRoot=false;this.shouldSetColors=false;this.shouldSetSubTitle=false;this.shouldUpdateDisplayDepth=false;this.shouldUpdateLabels=false;this.shouldAddStrokeUnder=false;this.shouldUpdateCursor=false;this.shouldUpdateData=false;this.shouldUpdateTableData=false;this.shouldValidate=false;this.shouldBindInteractivity=false;this.shouldUpdateDescriptionWrapper=false;this.shouldSetChartAccessibilityTitle=false;this.shouldSetChartAccessibilitySubtitle=false;this.shouldSetChartAccessibilityLongDescription=false;this.shouldSetChartAccessibilityExecutiveSummary=false;this.shouldSetChartAccessibilityStatisticalNotes=false;this.shouldSetChartAccessibilityStructureNotes=false;this.shouldSetParentSVGAccessibility=false;this.shouldSetGeometryAccessibilityAttributes=false;this.shouldSetGeometryAriaLabels=false;this.shouldSetGroupAccessibilityAttributes=false;this.shouldSetGroupAccessibilityLabel=false;this.shouldSetChartAccessibilityPurpose=false;this.shouldSetChartAccessibilityContext=false;this.shouldSetChartAccessibilityCount=false;this.shouldSetAnnotationAccessibility=false;this.shouldUpdateLayout=false;this.shouldSetTextures=false;this.shouldSetStrokes=false;this.shouldSetTextStrokes=false;this.shouldSetTagLevels=false;this.shouldRedrawWrapper=false;this.shouldSetIDs=false;this.shouldSetLocalizationConfig=false;this.innerInteractionKeys=[];this.defaultsLoaded={};this.bottomLevel="p";this.topLevel="h2";this.strokes={};this.setCircleFilter=(t,i,s)=>!r(s[i]).classed("moving")&&!this.accessibility.hideStrokes?this.filter:null;this.setIDs=()=>{this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)").attr("id",(t=>"circle-in-pack-"+this.generateValidId(t.data.id)))};this.generateValidId=t=>{const i=t instanceof Date?t.getTime():t;return(i+"-"+this.chartID).replace(/\W/g,"-")};this.setCircleStyle=(t,i,s)=>{const e=r(s[i].parentNode).datum();const h=e.data.data;const a=this.colorArr[e.depth]||"#fff";const n=qt(h,this.clickHighlight,this.innerInteractionKeys);const o=jt(h,this.hoverHighlight,this.innerInteractionKeys);const c=e.depth!==0?n&&this.clickStyle.color?Qt[this.clickStyle.color]||this.clickStyle.color||a:o&&this.hoverStyle.color?Qt[this.hoverStyle.color]||this.hoverStyle.color||a:a:a;r(s[i]).attr("stroke",n?ft(Qt[this.clickStyle.color]||this.clickStyle.color||this.preparedColors[e.depth]):o?ft(Qt[this.hoverStyle.color]||this.hoverStyle.color||this.preparedColors[e.depth]):this.strokes[e.depth]).attr("stroke-width",n?this.clickStyle.strokeWidth||3:o?this.hoverStyle.strokeWidth||2:!this.accessibility.hideStrokes?1:0).attr("stroke-dasharray",o&&!n?"4 3":"");return c};this.localization=l.localization;this.mainTitle=l.mainTitle;this.subTitle=l.subTitle;this.height=l.height;this.width=l.width;this.margin=l.margin;this.padding=l.padding;this.circlePadding=l.circlePadding;this.highestHeadingLevel=l.highestHeadingLevel;this.data=undefined;this.uniqueID=undefined;this.dataDepth=l.dataDepth;this.displayDepth=l.displayDepth;this.parentAccessor=l.parentAccessor;this.nodeAccessor=l.nodeAccessor;this.sizeAccessor=l.sizeAccessor;this.colorPalette=l.colorPalette;this.colors=undefined;this.cursor=l.cursor;this.hoverStyle=l.hoverStyle;this.clickStyle=l.clickStyle;this.hoverOpacity=l.hoverOpacity;this.animationConfig=l.animationConfig;this.showTooltip=l.showTooltip;this.tooltipLabel=l.tooltipLabel;this.dataLabel=l.dataLabel;this.dataKeyNames=undefined;this.annotations=l.annotations;this.accessibility=l.accessibility;this.suppressEvents=l.suppressEvents;this.interactionKeys=undefined;this.hoverHighlight=undefined;this.clickHighlight=l.clickHighlight;this.zoomToNode=undefined}dataWatcher(t,i){this.updated=true;this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldValidate=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true}titleWatcher(t,i){this.shouldValidate=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}subtitleWatcher(t,i){this.shouldSetSubTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetParentSVGAccessibility=true}headingWatcher(t,i){this.shouldRedrawWrapper=true;this.shouldSetTagLevels=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true;this.shouldSetAnnotationAccessibility=true}clusterWatcher(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true}nodeWatcher(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true}sizeWatcher(t,i){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldSetGeometryAriaLabels=true;this.shouldZoom=true}heightWatcher(t,i){this.shouldUpdateLayout=true;this.shouldResetRoot=true;this.shouldUpdateData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true}dataDepthWatcher(t,i){this.shouldUpdateData=true;this.shouldSetColors=true;this.shouldZoom=true}displayDepthWatcher(t,i){this.shouldUpdateDisplayDepth=true;this.shouldZoom=true}circlePaddingWatcher(t,i){this.shouldUpdateData=true;this.shouldZoom=true}colorsWatcher(t,i){this.shouldSetColors=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true}showTooltipWatcher(t,i){this.shouldDrawInteractionState=true}tooltipLabelWatcher(t,i){this.shouldUpdateTableData=true;this.shouldSetParentSVGAccessibility=true;this.shouldSetGeometryAriaLabels=true}hoverOpacityWatcher(t,i){this.shouldDrawInteractionState=true}interactionStyleWatcher(t,i){this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true}cursorWatcher(t,i){this.shouldUpdateCursor=true}clickWatcher(t,i){this.shouldDrawInteractionState=true}hoverWatcher(t,i){this.shouldDrawInteractionState=true}zoomWatcher(t,i){this.shouldZoom=true}interactionWatcher(t,i){this.shouldValidateInteractionKeys=true;this.shouldUpdateTableData=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAriaLabels=true}dataKeyNamesWatcher(t,i){this.shouldSetParentSVGAccessibility=true;this.shouldSetGroupAccessibilityLabel=true;this.shouldSetGeometryAriaLabels=true}labelWatcher(t,i){this.shouldUpdateTableData=true;this.shouldUpdateLabels=true;this.shouldAddStrokeUnder=true}accessibilityWatcher(t,i){this.shouldValidate=true;const s=t&&t.title?t.title:false;const e=i&&i.title?i.title:false;if(s!==e){this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}const h=t&&t.executiveSummary?t.executiveSummary:false;const r=i&&i.executiveSummary?i.executiveSummary:false;if(h!==r){this.shouldSetChartAccessibilityExecutiveSummary=true}const a=t&&t.purpose?t.purpose:false;const n=i&&i.purpose?i.purpose:false;if(a!==n){this.shouldSetChartAccessibilityPurpose=true}const o=t&&t.longDescription?t.longDescription:false;const c=i&&i.longDescription?i.longDescription:false;if(o!==c){this.shouldSetChartAccessibilityLongDescription=true}const l=t&&t.contextExplanation?t.contextExplanation:false;const u=i&&i.contextExplanation?i.contextExplanation:false;if(l!==u){this.shouldSetChartAccessibilityContext=true}const f=t&&t.statisticalNotes?t.statisticalNotes:false;const d=i&&i.statisticalNotes?i.statisticalNotes:false;if(f!==d){this.shouldSetChartAccessibilityStatisticalNotes=true}const p=t&&t.structureNotes?t.structureNotes:false;const g=i&&i.structureNotes?i.structureNotes:false;if(p!==g){this.shouldSetChartAccessibilityStructureNotes=true}const v=t&&t.includeDataKeyNames;const m=i&&i.includeDataKeyNames;const y=t&&t.elementDescriptionAccessor?t.elementDescriptionAccessor:false;const b=i&&i.elementDescriptionAccessor?i.elementDescriptionAccessor:false;if(v!==m||y!==b){if(v!==m){this.shouldSetGroupAccessibilityLabel=true}this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}const w=t&&t.hideTextures?t.hideTextures:false;const k=i&&i.hideTextures?i.hideTextures:false;if(w!==k){this.shouldSetTextures=true;this.shouldDrawInteractionState=true}const W=t&&t.hideStrokes?t.hideStrokes:false;const T=i&&i.hideStrokes?i.hideStrokes:false;if(W!==T){this.shouldSetStrokes=true;this.shouldDrawInteractionState=true}const A=t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled?t.keyboardNavConfig.disabled:false;const x=i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled?i.keyboardNavConfig.disabled:false;const D=t&&t.elementsAreInterface?t.elementsAreInterface:false;const S=i&&i.elementsAreInterface?i.elementsAreInterface:false;if(A!==x||D!==S){this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}if(D!==S){this.shouldDrawInteractionState=true}}localizationWatcher(t,i){this.shouldValidate=true;const s=t&&t.language?t.language:false;const e=i&&i.language?i.language:false;if(s!==e){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}const h=t&&t.numeralLocale?t.numeralLocale:false;const r=i&&i.numeralLocale?i.numeralLocale:false;if(h!==r){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}}annotationsWatcher(t,i){this.shouldValidate=true;this.shouldUpdateAnnotations=true;this.shouldSetAnnotationAccessibility=true}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}suppressWatcher(t,i){this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldValidate=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}componentWillLoad(){const t=this.uniqueID||"circle-pack-"+n();this.initialLoadEvent.emit({chartID:t});return new Promise((i=>{this.duration=0;this.chartID=t;this.circlePackingEl.id=this.chartID;this.setLocalizationConfig();this.setTagLevels();this.validateInteractionKeys();this.setTableData();this.setLayoutData();this.restructureData();this.shouldValidateAccessibilityProps();this.shouldValidateLocalizationProps();this.setColors();i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.renderRootElements();this.setTooltipInitialStyle();this.setChartDescriptionWrapper();this.setChartAccessibilityTitle();this.setChartAccessibilitySubtitle();this.setChartAccessibilityLongDescription();this.setChartAccessibilityExecutiveSummary();this.setChartAccessibilityPurpose();this.setChartAccessibilityContext();this.setChartAccessibilityStatisticalNotes();this.setChartAccessibilityStructureNotes();this.setParentSVGAccessibility();this.prepareChartForDrawing();this.reSetRoot();this.setTextures();this.setSubTitleElements();this.setStrokes();this.setTextStrokes();this.updateDisplayDepth();this.enterUpdateExitCircles(this.circleG,this.filterData(this.currentDepth));const i=this.getZoomTarget();this.drawZoomChildren(i);this.setChartCountAccessibility();this.setGeometryAccessibilityAttributes();this.setGeometryAriaLabels();this.addStrokeUnder();this.zoom(i);this.drawAnnotations();this.setAnnotationAccessibility();this.onChangeHandler();wt(this.root.node(),this.circleG.node(),true);t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{this.duration=!this.animationConfig||!this.animationConfig.disabled?750:0;this.prepareChartForDrawing();if(this.shouldResetRoot){this.reSetRoot();this.shouldResetRoot=false}if(this.shouldSetColors){this.setColors();this.shouldSetColors=false}if(this.shouldSetTextures){this.setTextures();this.shouldSetTextures=false}if(this.shouldSetStrokes){this.setStrokes();this.shouldSetStrokes=false}if(this.shouldSetTextStrokes){this.setTextStrokes();this.shouldSetTextStrokes=false}if(this.shouldSetIDs){this.setIDs();this.shouldSetIDs=false}if(this.shouldUpdateDescriptionWrapper){this.setChartDescriptionWrapper();this.shouldUpdateDescriptionWrapper=false}if(this.shouldSetChartAccessibilityCount){this.setChartCountAccessibility();this.shouldSetChartAccessibilityCount=false}if(this.shouldSetChartAccessibilityTitle){this.setChartAccessibilityTitle();this.shouldSetChartAccessibilityTitle=false}if(this.shouldSetChartAccessibilitySubtitle){this.setChartAccessibilitySubtitle();this.shouldSetChartAccessibilitySubtitle=false}if(this.shouldSetChartAccessibilityLongDescription){this.setChartAccessibilityLongDescription();this.shouldSetChartAccessibilityLongDescription=false}if(this.shouldSetChartAccessibilityExecutiveSummary){this.setChartAccessibilityExecutiveSummary();this.shouldSetChartAccessibilityExecutiveSummary=false}if(this.shouldSetChartAccessibilityPurpose){this.setChartAccessibilityPurpose();this.shouldSetChartAccessibilityPurpose=false}if(this.shouldSetChartAccessibilityContext){this.setChartAccessibilityContext();this.shouldSetChartAccessibilityContext=false}if(this.shouldSetChartAccessibilityStatisticalNotes){this.setChartAccessibilityStatisticalNotes();this.shouldSetChartAccessibilityStatisticalNotes=false}if(this.shouldSetChartAccessibilityStructureNotes){this.setChartAccessibilityStructureNotes();this.shouldSetChartAccessibilityStructureNotes=false}if(this.shouldSetParentSVGAccessibility){this.setParentSVGAccessibility();this.shouldSetParentSVGAccessibility=false}if(this.shouldUpdateDisplayDepth){this.updateDisplayDepth();this.shouldUpdateDisplayDepth=false}if(this.shouldZoom){const t=this.getZoomTarget();this.drawZoomChildren(t);this.zoom(t);this.shouldZoom=false}else if(this.shouldUpdateLabels){const t=this.getZoomTarget();if(t.children&&t.children.length){this.setLabelSelections(t.children)}this.shouldUpdateLabels=false}if(this.shouldAddStrokeUnder){this.addStrokeUnder();this.shouldAddStrokeUnder=false}if(this.shouldSetGeometryAccessibilityAttributes){this.setGeometryAccessibilityAttributes();this.shouldSetGeometryAccessibilityAttributes=false}if(this.shouldSetGeometryAriaLabels){this.setGeometryAriaLabels();this.shouldSetGeometryAriaLabels=false}if(this.shouldBindInteractivity){this.bindInteractivity();this.shouldBindInteractivity=false}if(this.shouldDrawInteractionState){this.updateInteractionState();this.shouldDrawInteractionState=false}if(this.shouldSetSubTitle){this.setSubTitleElements();this.shouldSetSubTitle=false}if(this.shouldUpdateCursor){this.updateCursor();this.shouldUpdateCursor=false}if(this.shouldUpdateAnnotations){this.drawAnnotations();this.shouldUpdateAnnotations=false}if(this.shouldSetAnnotationAccessibility){this.setAnnotationAccessibility();this.shouldSetAnnotationAccessibility=false}this.onChangeHandler();t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}shouldValidateLocalizationProps(){const t=lt();const i=t.i18Next.language;const s=t.i18Next.getResourceBundle(i);const e=t.numeral.localeData();if(this.shouldValidateLocalization&&!this.localization.skipValidation){this.shouldValidateLocalization=false;Yt(this.chartID,Object.assign(Object.assign({},this.localization),{language:s,numeralLocale:e}))}}shouldValidateAccessibilityProps(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=false;Xt(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:!this.suppressEvents?this.clickEvent.emit:undefined}})}}setTableData(){const t=Jt(this,Gt,"circle-packing");this.tableData=Rt(this.data,t);this.tableColumns=Object.keys(t)}setLayoutData(){this.padding=typeof this.padding==="string"?Ot(this.padding):this.padding;this.innerHeight=this.height-this.margin.top-this.margin.bottom;this.innerWidth=this.width-this.margin.left-this.margin.right;this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom;this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right}restructureData(){this.diameter=Math.min(this.innerPaddedWidth,this.innerPaddedHeight);this.holder=at().id((t=>t[this.nodeAccessor])).parentId((t=>t[this.parentAccessor]))(this.data);this.rootCircle=A(this.holder).sum((t=>t.data[this.sizeAccessor]||1)).sort(((t,i)=>i.data.value-t.data.value));this.nodes=Q().size([this.diameter-this.circlePadding,this.diameter-this.circlePadding]).padding(this.circlePadding)(this.rootCircle).descendants();this.innerDataDepth=this.dataDepth?Math.min(o(this.nodes,(t=>t.depth)),this.dataDepth):o(this.nodes,(t=>t.depth));this.nodes=this.nodes.filter((t=>!(t.depth>this.innerDataDepth)))}getLanguageString(){return ut(this.localization)}setLocalizationConfig(){ct(this.localization)}validateInteractionKeys(){this.innerInteractionKeys=!this.interactionKeys||this.interactionKeys&&this.interactionKeys.length===0?[this.nodeAccessor]:[...this.interactionKeys]}prepareChartForDrawing(){const t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";const i=this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).data()[0]:this.rootCircle;this.view=!this.view?[i.x,i.y,i.r*2]:this.view;this.zoomRatio=!this.zoomRatio?this.diameter/this.view[2]:this.zoomRatio;this.currentDepth=i.depth}renderRootElements(){this.svg=r(this.circlePackingEl).select(".visa-viz-circle-packing-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height).attr("data-testid","root-svg");this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID).attr("data-testid","margin-container");this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID).attr("data-testid","padding-container");this.circleG=this.rootG.append("g").attr("class","circle-pack-group").attr("data-testid","circle-group");this.textG=this.rootG.append("g").attr("class","circle-pack-text-group").attr("data-testid","dataLabel-group");this.subTitleG=r(this.circlePackingEl).select(".circle-packing-sub-title");this.tooltipG=r(this.circlePackingEl).select(".circle-packing-tooltip")}reSetRoot(){const t=ii({selection:this.svg,duration:this.duration,namespace:"root_reset"});t.attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height);const i=ii({selection:this.root,duration:this.duration,namespace:"root_reset"});i.attr("transform",`translate(${this.diameter/2+this.margin.left}, ${this.diameter/2+this.margin.top})`);const s=ii({selection:this.rootG,duration:this.duration,namespace:"root_reset"});s.attr("transform",`translate(${this.padding.left}, ${this.padding.top})`);if(typeof this.filter!=="undefined"){this.enterUpdateExitCircles(this.circleG,this.filterData(0))}Kt(this.chartID,this.width)}setGlobalSelections(){this.circle=this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)")}enterUpdateExitCircles(t,i){const s=i[0].depth;const e=t.selectAll(".g-level-"+s).data(i,(t=>t.data.id));this.enterCircle=e.enter().append("g");this.enterSize+=this.enterCircle.size();this.exitCircle=e.exit();this.enterCircles(s);this.exitCircles(this.exitCircle,true);this.updateParentCircle=e.merge(this.enterCircle);this.updateParentCircle.order();this.checkRecursion(s)}enterCircles(t){this.enterCircle.attr("class","g-level-"+t).attr("id",(t=>"circle-in-pack-"+this.generateValidId(t.data.id)));this.enterCircle.append("circle").attr("filter",this.setCircleFilter).classed("node node-level-"+t,true).classed("node--root",((t,i,s)=>{const e=r(s[i].parentNode).datum();return!e.parent})).on("mouseover",!this.suppressEvents?(t,i,s)=>{const e=r(s[i].parentNode).datum();this.onHoverHandler(e,s[i])}:null).on("mouseout",!this.suppressEvents?()=>{this.onMouseOutHandler()}:null).on("click",!this.suppressEvents?(t,i,s)=>{const e=r(s[i].parentNode).datum();if(!this.zooming){this.clickEvent.emit({data:e.data.data,target:s[i]})}}:null).attr("fill",this.setCircleStyle).attr("opacity",((t,i,s)=>{const e=r(s[i].parentNode).datum();const h=e.data.data;return Ht(h,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)})).each(((t,i,s)=>{gt(s[i]);mt({node:s[i],geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Jt(this,Gt,"circle-packing"),dataKeyNames:this.dataKeyNames,recursive:true,groupName:"node",uniqueID:this.chartID});yt({node:s[i],uniqueID:this.chartID});const e=r(s[i].parentNode).datum();let h=Ht(e,true,false,"",this.clickHighlight,this.innerInteractionKeys);h=this.clickHighlight&&this.clickHighlight.length?h:false;const a=this.accessibility.elementsAreInterface;It(s[i],h,a)})).attr("data-testid","circle").attr("data-id",((t,i,s)=>{const e=r(s[i].parentNode).datum();const h=e.data.data;return`circle-${h[this.parentAccessor]}-${h[this.nodeAccessor]}`})).attr("cursor",!this.suppressEvents?this.cursor:null).attr("transform",(t=>"translate("+Zt((t.x-this.view[0])*this.zoomRatio,4)+","+Zt((t.y-this.view[1])*this.zoomRatio,4)+")")).attr("r",0)}exitCircles(t,i){if(t.size()){this.exitSize+=t.size();if(i){this.exitSize+=t.selectAll("g").size()}const s=Pt(this.rootG.node());t.remove();this.setChartCountAccessibility();this.setGeometryAriaLabels();Nt({parentGNode:this.rootG.node(),focusDidExist:s,recursive:true})}}checkRecursion(t){this.updateParentCircle.each(((i,s,e)=>{const h=this.currentDepth+this.innerDisplayDepth;let a=0;if(i.depth+1<=h){a=t+1}if(a&&i.children&&i.children.length){this.enterUpdateExitCircles(r(e[s]),i.children)}else{this.exitCircles(r(e[s]).selectAll("g"),false)}}))}setLabelSelections(t){const i=this.textG.selectAll("text").data(t,(t=>(t.data||{}).id));this.enterText=i.enter().append("text");this.updateText=i.merge(this.enterText);this.exitText=i.exit().remove();this.enterLabels();this.drawLabels()}enterLabels(){this.enterText.attr("filter",this.textFilter).attr("class","label circle-packing-dataLabel").attr("cursor",!this.suppressEvents?this.cursor:null).attr("data-testid","dataLabel").attr("data-x",(t=>Zt((t.x-this.view[0])*this.zoomRatio,4))).attr("data-y",(t=>Zt((t.y-this.view[1])*this.zoomRatio,4))).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).attr("x",(t=>Zt((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>Zt((t.y-this.view[1])*this.zoomRatio,4))).attr("text-anchor","middle")}drawLabels(){this.updateText.attr("opacity",(t=>this.dataLabel.visible?1:0)).text((t=>this.dataLabel.labelAccessor?t.data.data[this.dataLabel.labelAccessor]:t.data.data[this.nodeAccessor]));if(!this.shouldZoom&&this.shouldUpdateLabels)this.placeLabels()}placeLabels(){const t=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;const i=this.updateText.classed("moving",((t,i,s)=>{const e=+r(s[i]).attr("data-x");const h=+r(s[i]).attr("data-y");const a=Zt((t.x-this.view[0])*this.zoomRatio,4);const n=Zt((t.y-this.view[1])*this.zoomRatio,4);return e!==a||h!==n})).attr("data-x",(t=>Zt((t.x-this.view[0])*this.zoomRatio,4))).attr("data-y",(t=>Zt((t.y-this.view[1])*this.zoomRatio,4))).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).style("visibility",((t,i,s)=>this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly?r(s[i]).style("visibility"):null)).attr("filter",null).transition("place").duration(this.duration);const s={all:{validPositions:["middle","top","bottom","left","right","bottom-right","bottom-left","top-left","top-right"],offsets:[1,1,2,4,4,1,1,1,1]},centroid:{validPositions:["middle"],offsets:[1]},top:{validPositions:["top","top-left","top-right"],offsets:[1,1,1]},middle:{validPositions:["middle","left","right"],offsets:[1,4,4]},bottom:{validPositions:["bottom","bottom-left","bottom-right"],offsets:[2,1,1]},right:{validPositions:["right","top-right","bottom-right"],offsets:[4,1,1]},left:{validPositions:["left","top-left","bottom-left"],offsets:[4,1,1]}};const e=this.dataLabel&&this.dataLabel.collisionPlacement;const h=t?["middle"]:e&&s[e]?s[e].validPositions:s["all"].validPositions;const a=t?[1]:e&&s[e]?s[e].offsets:s["all"].offsets;if(this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly)){this.bitmaps=si({labelSelection:i,avoidMarks:[],validPositions:h,offsets:a,accessors:[this.parentAccessor,this.nodeAccessor],size:[Zt(this.innerPaddedWidth),Zt(this.innerPaddedHeight)],hideOnly:this.dataLabel.visible&&t});if(t){i.attr("x",(t=>Zt((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>Zt((t.y-this.view[1])*this.zoomRatio,4)))}}else{i.attr("x",(t=>Zt((t.x-this.view[0])*this.zoomRatio,4))).attr("y",(t=>Zt((t.y-this.view[1])*this.zoomRatio,4)))}i.call(_t,(()=>{this.updateText.classed("moving",false);setTimeout((()=>{this.addStrokeUnder()}),0)}))}addStrokeUnder(){this.updateText.attr("filter",this.textFilter)}setTextStrokes(){this.textFilter=dt({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.filter=dt({root:this.svg.node(),id:this.chartID,color:"#ffffff",strokeSizeOverride:1})}bindInteractivity(){this.circle.on("mouseover",!this.suppressEvents?(t,i,s)=>{const e=r(s[i].parentNode).datum();this.onHoverHandler(e,s[i])}:null).on("mouseout",!this.suppressEvents?()=>{this.onMouseOutHandler()}:null).on("click",!this.suppressEvents?(t,i,s)=>{const e=r(s[i].parentNode).datum();if(!this.zooming){this.clickEvent.emit({data:e.data.data,target:s[i]})}}:null)}drawAnnotations(){Mt({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})}setAnnotationAccessibility(){Lt(this.getLanguageString(),this.circlePackingEl,this.annotations,undefined)}setSubTitleElements(){ei({root:this.subTitleG,subTitle:this.subTitle})}setColors(){this.preparedColors=this.colors?$t(this.colors):Vt(this.colorPalette,this.innerDataDepth+1)}setTextures(){const t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6){this.colorArr=this.preparedColors}else{const i=pt({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(i):i}}setStrokes(){this.strokes=[];this.preparedColors.forEach((t=>{this.strokes.push(ft(t))}))}updateDisplayDepth(){this.innerDisplayDepth=this.displayDepth?Math.min(o(this.nodes,(t=>t.depth)),this.displayDepth):o(this.nodes,(t=>t.depth));if(this.circleG){this.circleG.selectAll("g").each(((t,i,s)=>{if(t.depth>this.innerDisplayDepth){this.exitSize++;this.exitSize+=r(s[i]).selectAll("g").size();r(s[i]).remove()}}))}}updateCursor(){this.circle.attr("cursor",!this.suppressEvents?this.cursor:null)}updateInteractionState(){this.circle.attr("fill",this.setCircleStyle).attr("filter",this.setCircleFilter).attr("opacity",((t,i,s)=>{const e=r(s[i].parentNode).datum();const h=e.data.data;return Ht(h,1,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)})).each(((t,i,s)=>{const e=r(s[i].parentNode).datum();let h=Ht(e,true,false,"",this.clickHighlight,this.innerInteractionKeys);h=this.clickHighlight&&this.clickHighlight.length?h:false;const a=this.accessibility.elementsAreInterface;It(s[i],h,a)}));if(!this.zooming){Nt({parentGNode:this.rootG.node(),recursive:true})}}drawZoomChildren(t){if(t.children&&t.children.length){const i=this.generateValidId(t.data.id);this.enterUpdateExitCircles(this.rootG.select("#circle-in-pack-"+i),t.children);this.setGlobalSelections();this.setLabelSelections(t.children)}else if(t){this.setGlobalSelections();this.setLabelSelections([t])}}getZoomTarget(){const t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";return this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).datum():this.rootCircle}zoom(t){this.zooming=true;this.view=[t.x,t.y,t.r*2];this.zoomRatio=this.diameter/this.view[2];this.circle.classed("moving",((t,i,s)=>{const e=r(s[i].parentNode).datum();const h=+r(s[i]).attr("data-cx");const a=+r(s[i]).attr("data-cy");const n=+r(s[i]).attr("r");const o=Zt((e.x-this.view[0])*this.zoomRatio,4);const c=Zt((e.y-this.view[1])*this.zoomRatio,4);const l=e.r*this.zoomRatio;return n!==l||h!==o||a!==c})).attr("data-cx",((t,i,s)=>{const e=r(s[i].parentNode).datum();return Zt((e.x-this.view[0])*this.zoomRatio,4)})).attr("data-cy",((t,i,s)=>{const e=r(s[i].parentNode).datum();return Zt((e.y-this.view[1])*this.zoomRatio,4)})).attr("data-r",((t,i,s)=>{const e=r(s[i].parentNode).datum();return e.r*this.zoomRatio})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top);const i=this.circle.filter(".moving").attr("filter",null).transition("zoom").duration(this.duration).attr("transform",((t,i,s)=>{const e=r(s[i].parentNode).datum();return"translate("+Zt((e.x-this.view[0])*this.zoomRatio,4)+","+Zt((e.y-this.view[1])*this.zoomRatio,4)+")"})).attr("r",((t,i,s)=>{const e=r(s[i].parentNode).datum();return e.r*this.zoomRatio}));const s=()=>{this.zooming=false;this.circle.classed("moving",false);setTimeout((()=>{this.circle.attr("filter",this.setCircleFilter)}),0);Nt({parentGNode:this.rootG.node(),recursive:true});this.transitionEndEvent.emit({chartID:this.chartID})};if(this.duration&&i.size()>0){i.attrTween("x",((t,i,s)=>{const e=r(s[i]).classed("vcl-accessibility-focus-source");return()=>{if(e){Nt({parentGNode:this.rootG.node(),recursive:true})}return 0}})).call(_t,s)}else{s()}this.placeLabels()}onHoverHandler(t,i){Bt(this.chartID,true);this.hoverEvent.emit({data:t.data.data,target:i});if(this.showTooltip){this.eventsTooltip({data:t.data.data,evt:a,isToShow:true})}}onMouseOutHandler(){Bt(this.chartID,false);this.mouseOutEvent.emit();if(this.showTooltip){this.eventsTooltip({isToShow:false})}}setTooltipInitialStyle(){Ut(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){zt({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,dataKeyNames:this.dataKeyNames,ordinalAccessor:this.nodeAccessor,groupAccessor:this.parentAccessor,valueAccessor:this.sizeAccessor,chartType:"circle-packing"})}setTagLevels(){this.topLevel=ti(this.highestHeadingLevel);this.bottomLevel=ti(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){vt({language:this.getLanguageString(),rootEle:this.circlePackingEl,title:this.accessibility.title||this.mainTitle,chartTag:"circle-packing",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,recursive:true,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton});this.shouldRedrawWrapper=false}setParentSVGAccessibility(){bt({chartTag:"circle-packing",language:this.getLanguageString(),node:this.svg.node(),title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:Jt(this,Gt,"circle-packing"),dataKeyNames:this.dataKeyNames,groupAccessor:this.parentAccessor,groupName:"node",recursive:true,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})}setGeometryAccessibilityAttributes(){this.rootG.selectAll(".node").each(((t,i,s)=>{gt(s[i])}))}setGeometryAriaLabels(){const t=Jt(this,Gt,"circle-packing");this.rootG.selectAll(".node").each(((i,s,e)=>{mt({chartTag:"circle-packing",langauge:this.getLanguageString(),node:e[s],geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,recursive:true,groupName:"node",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled});yt({node:e[s],uniqueID:this.chartID})}))}setChartAccessibilityTitle(){kt(this.getLanguageString(),this.circlePackingEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){Wt(this.getLanguageString(),this.circlePackingEl,this.subTitle)}setChartAccessibilityLongDescription(){Tt(this.getLanguageString(),this.circlePackingEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){At(this.getLanguageString(),this.circlePackingEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){xt(this.getLanguageString(),this.circlePackingEl,this.accessibility.purpose)}setChartAccessibilityContext(){Dt(this.getLanguageString(),this.circlePackingEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){St(this.getLanguageString(),this.circlePackingEl,this.accessibility.statisticalNotes)}setChartCountAccessibility(){Ct({rootEle:this.circlePackingEl,parentGNode:this.circleG.node(),chartTag:"circle-packing",geomType:"node",groupName:"node",recursive:true})}setChartAccessibilityStructureNotes(){Et(this.getLanguageString(),this.circlePackingEl,this.accessibility.structureNotes)}onChangeHandler(){if(this.accessibility&&typeof this.accessibility.onChangeFunc==="function"){const t={updated:this.updated,added:this.enterSize,removed:this.exitSize};this.accessibility.onChangeFunc(t)}this.updated=false;this.enterSize=0;this.exitSize=0}filterData(t){return this.nodes.filter((i=>{if(i.depth===t){return true}return false}))}render(){this.drawStartEvent.emit({chartID:this.chartID});this.init();if(this.shouldSetLocalizationConfig){this.setLocalizationConfig();this.shouldSetLocalizationConfig=false}if(this.shouldSetTagLevels){this.setTagLevels();this.shouldSetTagLevels=false}if(this.shouldValidateInteractionKeys){this.validateInteractionKeys();this.shouldValidateInteractionKeys=false}if(this.shouldUpdateTableData){this.setTableData();this.shouldUpdateTableData=false}if(this.shouldValidate){this.shouldValidateAccessibilityProps();this.shouldValidateLocalizationProps();this.shouldValidate=false}if(this.shouldUpdateLayout){this.setLayoutData();this.shouldUpdateLayout=false}if(this.shouldUpdateData){this.restructureData();this.shouldUpdateData=false}return s("div",{key:"79ec0386c06e1e0c360cef9d80eafe35b5b69a52",class:"o-layout","data-testid":"outer-layout"},s("div",{key:"7866aa053778a794af1ca4d387ec727e42f6da62",class:"o-layout--chart","data-testid":"layout-chart"},s(this.topLevel,{key:"638cea8cdfcd360aa6fdb50791f169cba9a3902b","data-testid":"main-title"},this.mainTitle),s(this.bottomLevel,{key:"bd19899287b8cf655b1537874f22f7a46f7a320b",class:"visa-ui-text--instructions circle-packing-sub-title vcl-sub-title","data-testid":"sub-title"}),s("keyboard-instructions",{key:"3734584d4822584f3dd046d2dd75aebba16d17e6",uniqueID:this.chartID,geomType:"node",groupName:"node collection",language:this.getLanguageString(),chartTag:"circle-packing",width:this.width-(this.margin?this.margin.right||0:0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:true,disabled:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{key:"c8c32a11274566ca897d7e1c312af6fab62106d4",class:"visa-viz-circle-packing-container","data-testid":"chart-container"}),s("div",{key:"39aa91db80095f8ad5f9ae70c2a05bf74ff7da88",class:"circle-packing-tooltip vcl-tooltip","data-testid":"tooltip-container",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{key:"baa297fb4e9e490753f7e952642a663950db210b",uniqueID:this.chartID,language:this.getLanguageString(),unitTest:true,isCompact:true,tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton})))}init(){const t=Object.keys(l);let i=0;const s={showTooltip:{exception:false},circlePadding:{exception:0},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(i=0;i<t.length;i++){const e=!s[t[i]]?false:this[t[i]]===s[t[i]].exception;if(!(this[t[i]]||e)&&!(l[t[i]]===this[t[i]])){this[t[i]]=l[t[i]]}}}get circlePackingEl(){return e(this)}static get watchers(){return{data:["dataWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],parentAccessor:["clusterWatcher"],nodeAccessor:["nodeWatcher"],sizeAccessor:["sizeWatcher"],height:["heightWatcher"],width:["heightWatcher"],padding:["heightWatcher"],margin:["heightWatcher"],dataDepth:["dataDepthWatcher"],displayDepth:["displayDepthWatcher"],circlePadding:["circlePaddingWatcher"],colors:["colorsWatcher"],colorPalette:["colorsWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],hoverOpacity:["hoverOpacityWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],zoomToNode:["zoomWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],dataLabel:["labelWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],annotations:["annotationsWatcher"],uniqueID:["idWatcher"],suppressEvents:["suppressWatcher"]}}};window["VisaChartsLibOSSLicenses"]=Ft();hi.style=ot;export{hi as circle_packing};
//# sourceMappingURL=p-45e33cf7.entry.js.map