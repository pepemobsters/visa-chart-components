/**
 * Copyright (c) 2024 Visa, Inc.
 *
 * This source code is licensed under the MIT license
 * https://github.com/visa/visa-chart-components/blob/master/LICENSE
 *
 **/
import{r as t,c as i,h as s,g as e}from"./p-b0ab226b.js";import{U as h,s as a,e as l}from"./p-5fcd3c02.js";import{v as r}from"./p-b5f7528a.js";import{m as o}from"./p-e1d72334.js";import{c as n}from"./p-3f5e41ff.js";import{m as c}from"./p-f9c89fe4.js";import{w as u,s as d,c as f}from"./p-fa69d97e.js";import{b as p,a as v}from"./p-50f1a99e.js";import{x as g,y as m}from"./p-4f683f50.js";function b(t){return t.source}function y(t){return t.target}function k(t){let i=b,s=y,e=g,h=m,a=null,l=null,r=u(o);function o(){let o;const n=d.call(arguments);const c=i.apply(this,n);const u=s.apply(this,n);if(a==null)l=t(o=r());l.lineStart();n[0]=c,l.point(+e.apply(this,n),+h.apply(this,n));n[0]=u,l.point(+e.apply(this,n),+h.apply(this,n));l.lineEnd();if(o)return l=null,o+""||null}o.source=function(t){return arguments.length?(i=t,o):i};o.target=function(t){return arguments.length?(s=t,o):s};o.x=function(t){return arguments.length?(e=typeof t==="function"?t:f(+t),o):e};o.y=function(t){return arguments.length?(h=typeof t==="function"?t:f(+t),o):h};o.context=function(i){return arguments.length?(i==null?a=l=null:l=t(a=i),o):a};return o}function A(){return k(p)}function W(){return k(v)}const{propDefaultValues:w}=h;class x{}x.highestHeadingLevel=w.highestHeadingLevel;x.mainTitle="Alluvial Diagram Title";x.subTitle=w.subTitle.text;x.height=300;x.width=650;x.layout=w.layoutHorizontal;x.margin={top:300*.01,bottom:300*.01,right:650*.01,left:650*.01};x.padding={top:20,bottom:50,right:50,left:50};x.localization=w.localization;x.sourceAccessor="source";x.targetAccessor="target";x.valueAccessor="value";x.groupAccessor="";x.nodeIDAccessor="id";x.nodeConfig={fill:false,width:12,padding:20,alignment:"left",compare:false};x.linkConfig={visible:true,fillMode:"none",opacity:.3};x.accessibility=w.accessibility;x.animationConfig=w.animationConfig;x.colorPalette=w.colorPaletteCategorical;x.dataLabel=w.dataLabel;x.annotations=w.annotations;x.hoverStyle=w.hoverStyle;x.clickStyle=w.clickStyle;x.hoverOpacity=w.hoverOpacity;x.cursor=w.cursor;x.tooltipLabel=w.tooltipLabel;x.showTooltip=w.showTooltip;x.suppressEvents=w.suppressEvents;x.clickHighlight=w.clickHighlight;const L=".o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}alluvial-diagram{cursor:default}alluvial-diagram .annotations{pointer-events:none}alluvial-diagram .annotations .handle{pointer-events:all}alluvial-diagram .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}alluvial-diagram .data-table-link{color:#767676;text-decoration:none;font-size:12px;margin-left:5%}alluvial-diagram .hidden{display:none}alluvial-diagram .node rect{cursor:move}alluvial-diagram .node text{pointer-events:none;text-shadow:0 1px 0 #fff}alluvial-diagram .link{fill:none;stroke:#000;stroke-opacity:0.2}alluvial-diagram .link:hover{stroke-opacity:0.5}";const T=L;const{getGlobalInstances:C,configLocalization:D,getActiveLanguageString:E,initializeDescriptionRoot:S,setAccessibilityController:N,initializeElementAccess:I,setElementFocusHandler:j,setElementAccessID:P,setAccessChartCounts:O,hideNonessentialGroups:z,setAccessTitle:G,setAccessSubtitle:K,setAccessLongDescription:H,setAccessExecutiveSummary:M,setAccessPurpose:_,setAccessContext:q,setAccessStatistics:$,setAccessStructure:V,setAccessAnnotation:F,retainAccessFocus:R,checkAccessFocus:U,setElementInteractionAccessState:B,setAccessibilityDescriptionWidth:J,roundTo:Q,resolveLabelCollision:X,transitionEndAll:Y,annotate:Z,checkClicked:tt,checkInteraction:it,convertVisaColor:st,createTextStrokeFilter:et,drawTooltip:ht,findTagLevel:at,formatDataLabel:lt,formatStats:rt,getColors:ot,getContrastingStroke:nt,getPadding:ct,checkHovered:ut,initTooltipStyle:dt,overrideTitleTooltip:ft,scopeDataKeys:pt,chartAccessors:vt,sankey:gt,sankeyCenter:mt,sankeyJustify:bt,sankeyLeft:yt,sankeyLinkHorizontal:kt,sankeyLinkVertical:At,sankeyRight:Wt,prepareRenderChange:wt,visaColors:xt,validateAccessibilityProps:Lt,validateLocalizationProps:Tt,setSubTitle:Ct}=h;const Dt=class{constructor(s){t(this,s);this.clickEvent=i(this,"clickEvent",7);this.hoverEvent=i(this,"hoverEvent",7);this.mouseOutEvent=i(this,"mouseOutEvent",7);this.initialLoadEvent=i(this,"initialLoadEvent",7);this.initialLoadEndEvent=i(this,"initialLoadEndEvent",7);this.drawStartEvent=i(this,"drawStartEvent",7);this.drawEndEvent=i(this,"drawEndEvent",7);this.transitionEndEvent=i(this,"transitionEndEvent",7);this.shouldValidateAccessibility=true;this.shouldValidateLocalization=true;this.innerInteractionKeys=[];this.topLevel="h2";this.bottomLevel="p";this.sourceLinksString="sourceLinks";this.targetLinksString="targetLinks";this.valueString="value";this.updated=true;this.shouldSetDimensions=false;this.shouldUpdateData=false;this.shouldSetColors=false;this.shouldSetSubTitle=false;this.shouldSetTagLevels=false;this.shouldRedrawWrapper=false;this.shouldUpdateTableData=false;this.shouldUpdateDescriptionWrapper=false;this.shouldSetChartAccessibilityCount=false;this.shouldSetChartAccessibilityTitle=false;this.shouldSetChartAccessibilitySubtitle=false;this.shouldSetChartAccessibilityLongDescription=false;this.shouldSetChartAccessibilityExecutiveSummary=false;this.shouldSetChartAccessibilityPurpose=false;this.shouldSetChartAccessibilityContext=false;this.shouldSetChartAccessibilityStatisticalNotes=false;this.shouldSetChartAccessibilityStructureNotes=false;this.shouldSetParentSVGAccessibility=false;this.shouldSetGeometryAccessibilityAttributes=false;this.shouldSetGeometryAriaLabels=false;this.shouldSetGroupAccessibilityLabel=false;this.shouldSetSelectionClass=false;this.shouldSetAnnotationAccessibility=false;this.shouldSetGlobalSelections=false;this.shouldSetTestingAttributes=false;this.shouldDrawInteractionState=false;this.shouldEnterUpdateExit=false;this.shouldUpdateNodeGeometries=false;this.shouldUpdateNodeStyle=false;this.shouldUpdateLinkGeometries=false;this.shouldUpdateLinkStyle=false;this.shouldDrawNodeLabels=false;this.shouldSetNodeDimensions=false;this.shouldCallSankeyGenerator=false;this.shouldUpdateAnnotations=false;this.shouldValidateIdAccessor=false;this.shouldValidateLabelText=false;this.shouldValidateLinkFillMode=false;this.shouldValidateNodeAlignment=false;this.shouldValidateInteractionKeys=false;this.shouldValidateLinkGroups=false;this.shouldUpdateCursor=false;this.shouldBindInteractivity=false;this.shouldResetRoot=false;this.shouldSetNodeLabelOpacity=false;this.shouldSetLocalizationConfig=false;this.mainTitle=x.mainTitle;this.subTitle=x.subTitle;this.height=x.height;this.width=x.width;this.highestHeadingLevel=x.highestHeadingLevel;this.margin=x.margin;this.padding=x.padding;this.layout=x.layout;this.linkData=undefined;this.nodeData=undefined;this.uniqueID=undefined;this.localization=x.localization;this.sourceAccessor=x.sourceAccessor;this.targetAccessor=x.targetAccessor;this.valueAccessor=x.valueAccessor;this.groupAccessor=x.groupAccessor;this.nodeIDAccessor=x.nodeIDAccessor;this.nodeConfig=x.nodeConfig;this.linkConfig=x.linkConfig;this.colorPalette=x.colorPalette;this.colors=undefined;this.hoverStyle=x.hoverStyle;this.clickStyle=x.clickStyle;this.cursor=x.cursor;this.hoverOpacity=x.hoverOpacity;this.animationConfig=x.animationConfig;this.dataLabel=x.dataLabel;this.dataKeyNames=undefined;this.showTooltip=x.showTooltip;this.tooltipLabel=x.tooltipLabel;this.accessibility=x.accessibility;this.annotations=x.annotations;this.suppressEvents=x.suppressEvents;this.hoverHighlight=undefined;this.clickHighlight=x.clickHighlight;this.interactionKeys=undefined;this.unitTest=false}dataWatcher(t,i){this.updated=true;this.shouldUpdateData=true;this.shouldSetColors=true;this.shouldValidateIdAccessor=true;this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldUpdateTableData=true;this.shouldValidateLinkGroups=true;this.shouldValidateAccessibility=true;this.shouldSetGlobalSelections=true;this.shouldSetTestingAttributes=true;this.shouldEnterUpdateExit=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkGeometries=true;this.shouldDrawNodeLabels=true;this.shouldUpdateLinkStyle=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldSetGeometryAriaLabels=true;this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldUpdateAnnotations=true}idWatcher(t,i){console.error("Change detected in prop uniqueID from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}headingWatcher(t,i){this.shouldRedrawWrapper=true;this.shouldSetTagLevels=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetAnnotationAccessibility=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}mainTitleWatcher(t,i){this.shouldValidateAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}subTitleWatcher(t,i){this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetParentSVGAccessibility=true}dimensionWatcher(t,i){this.shouldSetDimensions=true;this.shouldSetNodeDimensions=true;this.shouldResetRoot=true;this.shouldCallSankeyGenerator=true;this.shouldSetGlobalSelections=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkGeometries=true;this.shouldUpdateLinkStyle=true;this.shouldDrawNodeLabels=true;this.shouldUpdateAnnotations=true}layoutWatcher(t,i){this.shouldSetDimensions=true;this.shouldSetNodeDimensions=true;this.shouldResetRoot=true;this.shouldCallSankeyGenerator=true;this.shouldSetGlobalSelections=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkGeometries=true;this.shouldUpdateLinkStyle=true;this.shouldDrawNodeLabels=true;this.shouldUpdateAnnotations=true;console.warn("Change detected in prop layout from value "+i+" to value "+t+". Transitions have yet to be designed in VCC for this prop.")}sourceAccessorWatcher(t,i){console.error("Change detected in prop sourceAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}targetAccessorWatcher(t,i){console.error("Change detected in prop targetAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}valueAccessorWatcher(t,i){this.shouldUpdateData=true;this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldUpdateTableData=true;this.shouldSetGlobalSelections=true;this.shouldEnterUpdateExit=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkGeometries=true;this.shouldUpdateLinkStyle=true;this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true;this.shouldDrawNodeLabels=true;this.shouldSetGeometryAriaLabels=true}groupAccessorWatcher(t,i){this.shouldUpdateData=true;this.shouldValidateLinkFillMode=true;this.shouldValidateLinkGroups=true;this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldUpdateTableData=true;this.shouldSetGlobalSelections=true;this.shouldEnterUpdateExit=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkGeometries=true;this.shouldUpdateLinkStyle=true;this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true;this.shouldDrawNodeLabels=true;this.shouldSetGeometryAriaLabels=true}nodeIDAccessorWatcher(t,i){console.error("Change detected in prop nodeIDAccessor from value "+i+" to value "+t+". This prop cannot be changed after component has loaded.")}nodeConfigWatcher(t,i){const s=t&&t.alignment;const e=i&&i.alignment;const h=t&&t.compare;const a=i&&i.compare;const l=t&&t.fill;const r=i&&i.fill;const o=t&&t.width;const n=i&&i.width;const c=t&&t.padding;const u=i&&i.padding;if(s!==e){this.shouldValidateNodeAlignment=true}if(s!==e||h!==a||o!==n||c!==u){this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldSetGlobalSelections=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateLinkGeometries=true;this.shouldDrawNodeLabels=true;this.shouldUpdateAnnotations=true}if(l!==r){this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkStyle=true}}linkConfigWatcher(t,i){const s=t&&t.fillMode;const e=i&&i.fillMode;const h=t&&t.visible;const a=i&&i.visible;if(s!==e){this.shouldValidateLinkFillMode=true;this.shouldSetGlobalSelections=true;this.shouldEnterUpdateExit=true;this.shouldUpdateLinkGeometries=true}if(h!==a){this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldSetGlobalSelections=true;this.shouldSetNodeLabelOpacity=true;this.shouldUpdateNodeGeometries=true;this.shouldUpdateLinkGeometries=true;this.shouldDrawNodeLabels=true;this.shouldUpdateAnnotations=true}this.shouldUpdateLinkStyle=true;this.shouldDrawInteractionState=true;this.shouldSetTestingAttributes=true}colorWatcher(t,i){this.shouldSetColors=true;this.shouldUpdateNodeStyle=true;this.shouldUpdateLinkStyle=true;this.shouldDrawInteractionState=true}interactionStyleWatcher(t,i){this.shouldSetColors=true;this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true}cursorWatcher(t,i){this.shouldUpdateCursor=true}hoverOpacityWatcher(t,i){this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true}dataLabelWatcher(t,i){const s=t&&t.visible;const e=i&&i.visible;const h=t&&t.labelAccessor?t.labelAccessor:false;const a=i&&i.labelAccessor?i.labelAccessor:false;if(h!==a){this.shouldValidateLabelText=true}this.shouldDrawNodeLabels=true;this.shouldUpdateTableData=true;if(s!==e){this.shouldSetNodeLabelOpacity=true}}tooltipLabelWatcher(t,i){this.shouldUpdateTableData=true;this.shouldSetParentSVGAccessibility=true;this.shouldSetGeometryAriaLabels=true}showTooltipWatcher(t,i){this.shouldDrawInteractionState=true}accessibilityWatcher(t,i){this.shouldValidateAccessibility=true;const s=t&&t.title?t.title:false;const e=i&&i.title?i.title:false;if(s!==e){this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}const h=t&&t.executiveSummary?t.executiveSummary:false;const a=i&&i.executiveSummary?i.executiveSummary:false;if(h!==a){this.shouldSetChartAccessibilityExecutiveSummary=true}const l=t&&t.purpose?t.purpose:false;const r=i&&i.purpose?i.purpose:false;if(l!==r){this.shouldSetChartAccessibilityPurpose=true}const o=t&&t.longDescription?t.longDescription:false;const n=i&&i.longDescription?i.longDescription:false;if(o!==n){this.shouldSetChartAccessibilityLongDescription=true}const c=t&&t.contextExplanation?t.contextExplanation:false;const u=i&&i.contextExplanation?i.contextExplanation:false;if(c!==u){this.shouldSetChartAccessibilityContext=true}const d=t&&t.statisticalNotes?t.statisticalNotes:false;const f=i&&i.statisticalNotes?i.statisticalNotes:false;if(d!==f){this.shouldSetChartAccessibilityStatisticalNotes=true}const p=t&&t.structureNotes?t.structureNotes:false;const v=i&&i.structureNotes?i.structureNotes:false;if(p!==v){this.shouldSetChartAccessibilityStructureNotes=true}const g=t&&t.includeDataKeyNames;const m=i&&i.includeDataKeyNames;const b=t&&t.elementDescriptionAccessor?t.elementDescriptionAccessor:false;const y=i&&i.elementDescriptionAccessor?i.elementDescriptionAccessor:false;if(g!==m||b!==y){if(g!==m){this.shouldSetGroupAccessibilityLabel=true}this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}const k=t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled?t.keyboardNavConfig.disabled:false;const A=i&&i.keyboardNavConfig&&i.keyboardNavConfig.disabled?i.keyboardNavConfig.disabled:false;const W=t&&t.elementsAreInterface?t.elementsAreInterface:false;const w=i&&i.elementsAreInterface?i.elementsAreInterface:false;if(k!==A||W!==w){this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}if(W!==w){this.shouldSetSelectionClass=true}}localizationWatcher(t,i){this.shouldValidateLocalization=true;const s=t&&t.language?t.language:false;const e=i&&i.language?i.language:false;if(s!==e){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}const h=t&&t.numeralLocale?t.numeralLocale:false;const a=i&&i.numeralLocale?i.numeralLocale:false;if(h!==a){this.shouldSetLocalizationConfig=true;this.shouldUpdateTableData=true;this.shouldRedrawWrapper=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}}annotationsWatcher(t,i){this.shouldValidateAccessibility=true;this.shouldSetAnnotationAccessibility=true;this.shouldUpdateAnnotations=true}clickWatcher(t,i){this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true;this.shouldSetSelectionClass=true}hoverWatcher(t,i){this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true}interactionWatcher(t,i){this.shouldSetNodeDimensions=true;this.shouldCallSankeyGenerator=true;this.shouldValidateInteractionKeys=true;this.shouldDrawInteractionState=true;this.shouldSetNodeLabelOpacity=true;this.shouldSetSelectionClass=true;this.shouldUpdateTableData=true;this.shouldSetGeometryAriaLabels=true;this.shouldBindInteractivity=true;this.shouldUpdateCursor=true}dataKeyNamesWatcher(t,i){this.shouldSetParentSVGAccessibility=true;this.shouldSetGroupAccessibilityLabel=true;this.shouldSetGeometryAriaLabels=true}suppressWatcher(t,i){this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldValidateAccessibility=true;this.shouldRedrawWrapper=true;this.shouldSetSubTitle=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}unitTestWatcher(t,i){this.shouldSetTestingAttributes=true}componentWillLoad(){const t=this.uniqueID||"alluvial-diagram-"+r();this.initialLoadEvent.emit({chartID:t});return new Promise((i=>{this.duration=0;this.defaults=true;this.chartID=t;this.alluvialDiagramEl.id=this.chartID;this.setLocalizationConfig();this.setTagLevels();this.prepareData();this.setDimensions();this.validateIdAccessor();this.validateLabelText();this.validateLinkFillMode();this.validateNodeAlignment();this.validateInteractionKeys();this.validateLinkGroups();this.shouldValidateAccessibilityProps();this.shouldValidateLocalizationProps();this.setColors();this.setNodeDimensions();this.callSankeyGenerator();this.setTableData();i("component will load")}))}componentWillUpdate(){return new Promise((t=>{t("component will update")}))}componentDidLoad(){return new Promise((t=>{this.shouldValidateAccessibilityProps();this.shouldValidateLocalizationProps();this.renderRootElements();this.setTooltipInitialStyle();this.setChartDescriptionWrapper();this.setChartAccessibilityTitle();this.setChartAccessibilitySubtitle();this.setChartAccessibilityLongDescription();this.setChartAccessibilityExecutiveSummary();this.setChartAccessibilityPurpose();this.setChartAccessibilityContext();this.setChartAccessibilityStatisticalNotes();this.setChartAccessibilityStructureNotes();this.setParentSVGAccessibility();this.reSetRoot();this.setSubTitleElements();this.setGlobalSelections();this.setTestingAttributes();this.enterLinkGeometries();this.updateLinkGeometries();this.exitLinkGeometries();this.enterNodeGeometries();this.updateNodeGeometries();this.exitNodeGeometries();this.enterNodeLabels();this.updateNodeLabels();this.exitNodeLabels();this.updateLinkStyle();this.drawNodeGeometries();this.drawLinkGeometries();this.setGeometryAccessibilityAttributes();this.setGeometryAriaLabels();this.setGroupAccessibilityID();this.setChartCountAccessibility();this.setSelectedClass();this.updateCursor();this.drawNodeLabels();this.bindInteractivity();this.drawAnnotations();this.setAnnotationAccessibility();this.onChangeHandler();this.duration=750;this.defaults=false;z(this.root.node(),null);t("component did load")})).then((()=>this.initialLoadEndEvent.emit({chartID:this.chartID})))}componentDidUpdate(){return new Promise((t=>{this.duration=!this.animationConfig||!this.animationConfig.disabled?750:0;if(this.shouldUpdateDescriptionWrapper){this.setChartDescriptionWrapper();this.shouldUpdateDescriptionWrapper=false}if(this.shouldSetChartAccessibilityCount){this.setChartCountAccessibility();this.shouldSetChartAccessibilityCount=false}if(this.shouldSetChartAccessibilityTitle){this.setChartAccessibilityTitle();this.shouldSetChartAccessibilityTitle=false}if(this.shouldSetChartAccessibilitySubtitle){this.setChartAccessibilitySubtitle();this.shouldSetChartAccessibilitySubtitle=false}if(this.shouldSetChartAccessibilityLongDescription){this.setChartAccessibilityLongDescription();this.shouldSetChartAccessibilityLongDescription=false}if(this.shouldSetChartAccessibilityExecutiveSummary){this.setChartAccessibilityExecutiveSummary();this.shouldSetChartAccessibilityExecutiveSummary=false}if(this.shouldSetChartAccessibilityPurpose){this.setChartAccessibilityPurpose();this.shouldSetChartAccessibilityPurpose=false}if(this.shouldSetChartAccessibilityContext){this.setChartAccessibilityContext();this.shouldSetChartAccessibilityContext=false}if(this.shouldSetChartAccessibilityStatisticalNotes){this.setChartAccessibilityStatisticalNotes();this.shouldSetChartAccessibilityStatisticalNotes=false}if(this.shouldSetChartAccessibilityStructureNotes){this.setChartAccessibilityStructureNotes();this.shouldSetChartAccessibilityStructureNotes=false}if(this.shouldSetParentSVGAccessibility){this.setParentSVGAccessibility();this.shouldSetParentSVGAccessibility=false}if(this.shouldResetRoot){this.reSetRoot();this.shouldResetRoot=false}if(this.shouldSetGlobalSelections){this.setGlobalSelections();this.shouldSetGlobalSelections=false}if(this.shouldSetTestingAttributes){this.setTestingAttributes();this.shouldSetTestingAttributes=false}if(this.shouldSetSubTitle){this.setSubTitleElements();this.shouldSetSubTitle=false}if(this.shouldEnterUpdateExit){this.enterLinkGeometries();this.updateLinkGeometries();this.exitLinkGeometries();this.enterNodeGeometries();this.updateNodeGeometries();this.exitNodeGeometries();this.enterNodeLabels();this.updateNodeLabels();this.exitNodeLabels();this.shouldEnterUpdateExit=false}if(this.shouldUpdateNodeGeometries){this.drawNodeGeometries();this.shouldUpdateNodeGeometries=false}if(this.shouldUpdateNodeStyle){this.updateNodeStyle();this.shouldUpdateNodeStyle=false}if(this.shouldUpdateLinkGeometries){this.drawLinkGeometries();this.shouldUpdateLinkGeometries=false}if(this.shouldUpdateLinkStyle){this.updateLinkStyle();this.shouldUpdateLinkStyle=false}if(this.shouldSetGeometryAccessibilityAttributes){this.setGeometryAccessibilityAttributes();this.shouldSetGeometryAccessibilityAttributes=false}if(this.shouldSetGeometryAriaLabels){this.setGeometryAriaLabels();this.shouldSetGeometryAriaLabels=false}if(this.shouldSetGroupAccessibilityLabel){this.setGroupAccessibilityID();this.shouldSetGroupAccessibilityLabel=false}if(this.shouldDrawNodeLabels){this.drawNodeLabels();this.shouldDrawNodeLabels=false}if(this.shouldDrawInteractionState){this.updateInteractionState();this.shouldDrawInteractionState=false}if(this.shouldSetNodeLabelOpacity){this.setNodeLabelOpacity();this.shouldSetNodeLabelOpacity=false}if(this.shouldSetSelectionClass){this.setSelectedClass();this.shouldSetSelectionClass=false}if(this.shouldUpdateCursor){this.updateCursor();this.shouldUpdateCursor=false}if(this.shouldBindInteractivity){this.bindInteractivity();this.shouldBindInteractivity=false}if(this.shouldUpdateAnnotations){this.drawAnnotations();this.shouldUpdateAnnotations=false}if(this.shouldSetAnnotationAccessibility){this.setAnnotationAccessibility();this.shouldSetAnnotationAccessibility=false}this.onChangeHandler();t("component did update")})).then((()=>this.drawEndEvent.emit({chartID:this.chartID})))}setDimensions(){this.padding=typeof this.padding==="string"?ct(this.padding):this.padding;if(this.layout==="vertical"){this.innerWidth=this.height-this.margin.top-this.margin.bottom;this.innerHeight=this.width-this.margin.left-this.margin.right;this.innerPaddedHeight=this.innerHeight-this.padding.left-this.padding.right;this.innerPaddedWidth=this.innerWidth-this.padding.top-this.padding.bottom}else{this.innerWidth=this.width-this.margin.left-this.margin.right;this.innerHeight=this.height-this.margin.top-this.margin.bottom;this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom;this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right}}prepareData(){this.nodeList=[];this.linkList=[];this.linkData.forEach(((t,i)=>{const s={source:t[this.sourceAccessor],target:t[this.targetAccessor],value:t[this.valueAccessor],data:t};if(this.groupAccessor){s[this.groupAccessor]=t[this.groupAccessor]}this.linkList[i]=s}));this.nodeData&&this.nodeData.length>1?this.nodeList=this.nodeData:this.createNodeList()}createNodeList(){this.nodeList=[];this.linkData.map((t=>{if(!this.nodeList.some((i=>i.id===t[this.sourceAccessor]))){const i={id:t[this.sourceAccessor]};this.nodeList.push(i)}if(!this.nodeList.some((i=>i.id===t[this.targetAccessor]))){const i={id:t[this.targetAccessor]};this.nodeList.push(i)}}))}validateLabelText(){this.innerLabelAccessor=this.dataLabel.labelAccessor?this.dataLabel.labelAccessor:this.valueString}validateIdAccessor(){this.innerIDAccessor=this.nodeData&&this.nodeData.length>1?this.nodeList[0][this.nodeIDAccessor]?this.nodeIDAccessor:"id":"id"}validateLinkFillMode(){this.innerLinkFillMode=this.groupAccessor&&this.linkConfig.fillMode==="group"?"group":this.linkConfig.fillMode==="source"?"source":this.linkConfig.fillMode==="target"?"target":this.linkConfig.fillMode==="link"?"link":"none"}validateNodeAlignment(){this.innerNodeAlignment=this.layout==="vertical"?this.nodeConfig.alignment==="bottom"?Wt:this.nodeConfig.alignment==="middle"?mt:this.nodeConfig.alignment==="justify"?bt:yt:this.nodeConfig.alignment==="right"?Wt:this.nodeConfig.alignment==="center"?mt:this.nodeConfig.alignment==="justify"?bt:yt}validateInteractionKeys(){this.innerInteractionKeys=[];this.innerInteractionKeys=this.interactionKeys&&this.interactionKeys.length?this.interactionKeys:[this.sourceAccessor,this.targetAccessor]}validateLinkGroups(){this.groupKeys=[];if(this.groupAccessor){this.groupKeys=this.linkData.map((t=>t[this.groupAccessor])).filter(((t,i,s)=>s.indexOf(t)===i))}}shouldValidateLocalizationProps(){const t=C();const i=t.i18Next.language;const s=t.i18Next.getResourceBundle(i);const e=t.numeral.localeData();if(this.shouldValidateLocalization&&!this.localization.skipValidation){this.shouldValidateLocalization=false;Tt(this.chartID,Object.assign(Object.assign({},this.localization),{language:s,numeralLocale:e}))}}shouldValidateAccessibilityProps(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=false;Lt(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.linkData,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:this.suppressEvents?undefined:this.clickEvent.emit}})}}getLanguageString(){return E(this.localization)}setLocalizationConfig(){D(this.localization)}setTableData(){const t=["nodeIDAccessor","valueAccessor"];const i={singleAccessors:t,nestedAccessors:[{objectName:"dataLabel",objectAccessors:["labelAccessor"],formatAccessors:["format"]}]};const s=pt(this,i,"alluvial-diagram");this.tableData=this.getScopedTableData(this.preppedData.nodes,s);this.tableColumns=Object.keys(s);const e=vt;delete e.nestedAccessors[2];const h=pt(this,e,"alluvial-diagram-secondary-table");this.secondaryTableData=this.getScopedTableData(this.preppedData.links,h);this.secondaryTableColumns=Object.keys(h)}getScopedTableData(t,i){const s=[];t.forEach((t=>{const e={};Object.keys(i).forEach((s=>{if("data"in t&&t.data[s]){e[s]=i[s]&&t.data[s]?rt(t.data[s],i[s]):t.data[s]}else{if(s===this.valueAccessor){e[s]=i[s]?rt(t[this.valueString],i[s]):t[this.valueString]}else{e[s]=i[s]&&t[s]?rt(t[s],i[s]):t[s]}}}));s.push(e)}));return s}setNodeDimensions(){this.alluvialProperties=gt(this.nodeConfig.compare,this.linkConfig.visible,this.layout).nodeId((t=>t[this.innerIDAccessor])).nodeWidth(this.nodeConfig.width).nodePadding(this.nodeConfig.padding).nodeAlign(this.innerNodeAlignment).nodeSort(null).size([this.innerPaddedWidth,this.innerPaddedHeight])}callSankeyGenerator(){const t=(t,i)=>this.alluvialProperties({nodes:t.map((t=>Object.assign({},t))),links:i.map((t=>Object.assign({},t)))});this.preppedData=t(this.nodeList,this.linkList);this.nodeCount=o(this.preppedData.nodes,(t=>t.layer))}renderRootElements(){this.svg=a(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").append("svg").attr("width",this.width).attr("height",this.height);this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID);this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID);this.nodeG=this.rootG.append("g").attr("class","alluvial-node-group");this.linkG=this.rootG.append("g").attr("class","alluvial-link-group");this.labelG=this.rootG.append("g").attr("class","alluvial-dataLabel-group");this.subTitleG=a(this.alluvialDiagramEl).select(".alluvial-sub-title");this.tooltipG=a(this.alluvialDiagramEl).select(".alluvial-tooltip")}updateCursor(){this.updateLinks.attr("cursor",!this.suppressEvents?this.cursor:null);this.updatingLabels.attr("cursor",!this.suppressEvents&&this.dataLabel.visible?this.cursor:null)}reSetRoot(){const t=wt({selection:this.svg,duration:this.duration,namespace:"root_reset",easing:n});t.attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height);const i=wt({selection:this.root,duration:this.duration,namespace:"root_reset",easing:n});i.attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);const s=wt({selection:this.rootG,duration:this.duration,namespace:"root_reset",easing:n});s.attr("transform",`translate(${this.padding.left}, ${this.padding.top})`);J(this.chartID,this.width)}setGlobalSelections(){if(this.currentNodeLayers){this.previousNodeLayers=this.currentNodeLayers}const t=this.nodeG.selectAll(".node-wrapper").data(this.preppedData.nodes,(t=>t[this.innerIDAccessor]));this.enterNodes=t.enter().append("g").attr("class","node-wrapper").attr("data-offset-group","true");this.enterNodes.append("rect").attr("class","alluvial-node");this.exitNodes=t.exit();this.updateNodes=t.merge(this.enterNodes);this.updateNodes.selectAll(".alluvial-node").data((t=>[t]));this.currentNodeLayers=this.preppedData.nodes;if(this.previousNodeLayers){const t=this.currentNodeLayers.filter((t=>this.previousNodeLayers.map((t=>t[this.innerIDAccessor])).includes(t.id)));this.previousMaxNodeLayer=o(t,(t=>t.layer));this.previousMinNodeLayer=c(t,(t=>t.layer));const i=this.previousNodeLayers.filter((t=>this.currentNodeLayers.map((t=>t[this.innerIDAccessor])).includes(t.id)));this.currentMaxNodeLayer=o(i,(t=>t.layer));this.currentMinNodeLayer=c(i,(t=>t.layer))}if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){this.updateNodes.each(((t,i,s)=>{I(s[i])}));const t=this.preppedData.nodes;const i=this.linkG.selectAll(".alluvial-link-wrapper").data(t,(t=>t[this.innerIDAccessor]));this.enterLinkGroups=i.enter().append("g");this.exitLinkGroups=i.exit().remove();this.updateLinkGroups=i.merge(this.enterLinkGroups);const s=this.updateLinkGroups.selectAll(".alluvial-link").data((t=>t.sourceLinks),(t=>t.data[this.sourceAccessor]+t.data[this.targetAccessor]));this.enterLinks=s.enter().append("path");this.exitLinks=s.exit();this.updateLinks=s.merge(this.enterLinks).attr("data-offset-element",this.innerLinkFillMode)}else{this.updateNodes.attr("tabindex",null);const t=this.linkG.selectAll(".alluvial-link").data(this.preppedData.links,(t=>t.data[this.sourceAccessor]+t.data[this.targetAccessor]));this.enterLinks=t.enter().append("path");this.exitLinks=t.exit();this.updateLinks=t.merge(this.enterLinks).attr("data-offset-element",null)}this.exitSize=this.exitLinks.size();this.enterSize=this.enterLinks.size();const i=this.labelG.selectAll("text").data(this.preppedData.nodes,(t=>t[this.innerIDAccessor]));this.enteringLabels=i.enter().append("text");this.exitingLabels=i.exit();this.updatingLabels=i.merge(this.enteringLabels)}setTestingAttributes(){if(this.unitTest){a(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").attr("data-testid","chart-container");a(this.alluvialDiagramEl).select(".alluvial-main-title").attr("data-testid","main-title");a(this.alluvialDiagramEl).select(".alluvial-sub-title").attr("data-testid","sub-title");this.svg.attr("data-testid","root-svg");this.root.attr("data-testid","margin-container");this.rootG.attr("data-testid","padding-container");this.tooltipG.attr("data-testid","tooltip-container");this.updateNodes.attr("data-testid","node").attr("data-id",(t=>`node-${t[this.innerIDAccessor]}`));if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){this.updateLinkGroups.attr("data-testid","alluvial-link-group").attr("data-id",(t=>`link-group-${t[this.innerIDAccessor]}`))}this.updateLinks.attr("data-testid","link").attr("data-id",(t=>`link-${t.source[this.innerIDAccessor]}-${t.target[this.innerIDAccessor]}`));this.updatingLabels.attr("data-testid","dataLabel").attr("data-id",(t=>`dataLabel-${t[this.innerIDAccessor]}`));this.svg.select("defs").attr("data-testid","pattern-defs")}else{a(this.alluvialDiagramEl).select(".visa-viz-d3-alluvial-container").attr("data-testid",null);a(this.alluvialDiagramEl).select(".alluvial-main-title").attr("data-testid",null);a(this.alluvialDiagramEl).select(".alluvial-sub-title").attr("data-testid",null);this.svg.attr("data-testid",null);this.root.attr("data-testid",null);this.rootG.attr("data-testid",null);this.tooltipG.attr("data-testid",null);this.updateNodes.attr("data-testid",null).attr("data-id",null);if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){this.updateLinkGroups.attr("data-testid",null).attr("data-id",null)}this.updateLinks.attr("data-testid",null).attr("data-id",null);this.updatingLabels.attr("data-testid",null).attr("data-id",null);this.svg.select("defs").attr("data-testid",null)}}newColumnInterpolationPosition(){return A().source((t=>t.target.layer<=this.previousMinNodeLayer?[t.source.x0,t.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.target.x1,t.y0]:[t.source.x1,t.y0])).target((t=>t.target.layer<=this.previousMinNodeLayer?[t.source.x0,t.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.target.x1,t.y0]:[t.target.x0,t.y1]))}newColumnInterpolationPositionVertical(){return W().source((t=>t.target.layer<=this.previousMinNodeLayer?[t.x0,t.source.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.x0,t.target.y1]:[t.x0,t.source.y1])).target((t=>t.target.layer<=this.previousMinNodeLayer?[t.x0,t.source.y0]:t.source.layer>=this.previousMaxNodeLayer?[t.x0,t.target.y1]:[t.x1,t.target.y0]))}enterLinkGeometries(){this.enterLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){this.enterLinkGroups.attr("class","alluvial-link-wrapper")}this.enterLinks.attr("class","alluvial-link").classed("entering",true).attr("d",this.layout==="vertical"?this.newColumnInterpolationPositionVertical():this.newColumnInterpolationPosition());this.enterLinks.attr("cursor",!this.suppressEvents?this.cursor:null).on("click",!this.suppressEvents?(t,i,s)=>this.onClickHandler(t,s[i]):null).on("mouseover",!this.suppressEvents?(t,i,s)=>this.onHoverHandler(t,s[i]):null).on("mouseout",!this.suppressEvents?()=>this.onMouseOutHandler():null).attr("stroke-dasharray",((t,i,s)=>{t.linelength=s[i].getTotalLength()-2;return t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?"":t.linelength+" "+t.linelength})).attr("stroke-dashoffset",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?0:t.linelength)).attr("stroke-width",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?Math.max(1,t.width):.1)).attr("stroke-opacity",t).transition("enter").duration(this.duration).ease(n).attr("d",this.layout==="vertical"?At():kt()).attr("stroke-width",(t=>t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?Math.max(1,t.width):1)).attr("stroke-dashoffset",0)}updateLinkGeometries(){this.updateLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.updateLinks.transition("opacity").ease(n).duration(this.duration).attr("stroke-opacity",(i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)))}exitLinkGeometries(){this.exitLinks.interrupt();const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.exitLinks.attr("stroke-dasharray",((t,i,s)=>{t.linelength=s[i].getTotalLength();return t.target.layer<=this.previousMinNodeLayer||t.source.layer>=this.previousMaxNodeLayer?"":t.linelength+" "+t.linelength})).transition("exit").ease(n).duration(this.duration).attr("d",this.layout==="vertical"?this.newColumnInterpolationPositionVertical():this.newColumnInterpolationPosition()).attr("stroke-opacity",t).attr("stroke-dashoffset",(t=>t.linelength)).attr("stroke-width",(t=>t.target.layer<=this.currentMinNodeLayer||t.source.layer>=this.currentMaxNodeLayer?Math.max(1,t.width):.1)).remove()}drawLinkGeometries(){this.removeTemporaryClickedLinks(this.svg.node());if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){this.updateLinkGroups.classed("link-group offset-target",true)}this.updateLinks.transition("update").duration(this.duration).ease(n).attr("d",this.layout==="vertical"?At():kt()).attr("stroke-width",(t=>Math.max(1,t.width))).call(Y,(()=>{this.removeTemporaryClickedLinks(this.svg.node());this.updateLinks.classed("entering",false).attr("d",this.layout==="vertical"?At():kt()).attr("stroke-dasharray","");this.updateInteractionState();this.updateLinks.each(((t,i,s)=>{const e=this.clickHighlight&&this.clickHighlight.length>0&&tt(t.data,this.clickHighlight,this.innerInteractionKeys);if(e){this.drawDuplicateClickedLink(s[i],t)}}))}));this.updateLinks.transition("accessibilityAfterExit").duration(this.duration).ease(n).call(Y,(()=>{const t=U(this.rootG.node());this.exitLinks.remove();this.setChartCountAccessibility();this.setGroupAccessibilityID();this.setGeometryAriaLabels();R({parentGNode:this.rootG.node(),focusDidExist:t});this.transitionEndEvent.emit({chartID:this.chartID})}))}drawDuplicateClickedLink(t,i){const s=t;const e="vcl-accessibility-focus";const h=s.parentNode;const l=s.cloneNode();a(l).classed("alluvial-link",false).classed(e+"-highlight "+e+"-hover",true).classed("duplicated-clicked-link",true).classed("entering",false).data([i.data]).attr("focusable",false).attr("aria-label",null).attr("aria-hidden",true).attr("role",null).style("pointer-events","none").attr("tabindex",null);if(this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target"){const t=h.parentNode;const i=a(t).selectAll(".link-group")._groups[0];const s=i[i.length-1];s.appendChild(l)}else{h.appendChild(l)}}removeTemporaryClickedLinks(t){a(t).selectAll(".duplicated-clicked-link").remove()}updateLinkStyle(){this.updateLinks.attr("stroke",(t=>this.clickHighlight.length>0&&tt(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?xt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&ut(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?xt[this.hoverStyle.color]||this.hoverStyle.color:this.innerLinkFillMode==="group"?this.colorArr[this.groupKeys.indexOf(t[this.groupAccessor])]:this.innerLinkFillMode==="none"?this.colorArr[0]||"#E4E4E4":this.innerLinkFillMode==="link"?this.colorArr[t.index]:this.innerLinkFillMode==="source"?this.colorArr[t.source.index]:this.colorArr[t.target.index])).attr("fill","none")}enterNodeGeometries(){this.enterNodes.interrupt();if(!this.defaults){this.enterNodes.classed("entering",true)}this.enterNodes.select(".alluvial-node").attr("fill",((t,i)=>this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4")).attr("stroke",((t,i)=>nt(this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4"))).attr("stroke-width","1px").attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("height",(t=>t.y1-t.y0)).attr("opacity",0).attr("width",(t=>t.x1-t.x0))}updateNodeGeometries(){this.updateNodes.interrupt();this.updateNodes.select(".alluvial-node").transition("node_opacity").duration(((t,i,s)=>{if(a(s[i].parentNode).classed("entering")){return this.duration/3}return 0})).delay(((t,i,s)=>a(s[i].parentNode).classed("entering")?this.duration/1.2:0)).ease(n).attr("opacity",1)}exitNodeGeometries(){this.exitNodes.interrupt();this.exitNodes.select(".alluvial-node").transition("exit").ease(n).duration(this.duration/3).attr("opacity",0).attr("width",0).select((function(){return this.parentNode})).remove()}drawNodeGeometries(){this.updateNodes.select(".alluvial-node").transition("update_nodes").duration(((t,i,s)=>a(s[i].parentNode).classed("entering")?this.duration/3:this.duration)).delay(((t,i,s)=>a(s[i].parentNode).classed("entering")?this.duration/1.2:0)).ease(n).attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("height",(t=>t.y1-t.y0)).attr("width",(t=>t.x1-t.x0)).attr("opacity",1).call(Y,(()=>{this.updateNodes.classed("entering",false)}))}updateNodeStyle(){this.updateNodes.select(".alluvial-node").attr("fill",((t,i)=>this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4"));this.updateNodes.select(".alluvial-node").attr("stroke",((t,i)=>nt(this.nodeConfig.fill?this.colorArr[i]||this.colorArr[0]:"#E4E4E4")));this.updateNodes.select(".alluvial-node").attr("stroke-width","1px")}placeNodeLabels({root:t,layout:i,dataLabel:s,innerPaddedWidth:e}){let h,a,l,r,o;if(i==="vertical"){switch(s.placement){case"outside":h=t=>t.x0+(t.x1-t.x0)/2;a=t=>t.y0<e/2?t.y0:t.y1;l="0.0em";r=t=>t.y0<e/2?"-0.5em":"1.3em";o="middle";break;case"on-node":h=t=>t.x0+(t.x1-t.x0)/2;a=t=>t.y0+(t.y1-t.y0)/2;l="0.0em";r="0.4em";o="middle";break;case"inside":h=t=>t.x0+(t.x1-t.x0)/2;a=t=>t.y0<e/2?t.y1:t.y0;l="0.0em";r=t=>t.y0<e/2?"1.3em":"-0.5em";o="middle";break;default:h=t=>t.x0+(t.x1-t.x0)/2;a=t=>t.y0<e/2?t.y1:t.y0;l="0.0em";r=t=>t.y0<e/2?"1.3em":"-0.5em";o="middle";break}}else{switch(s.placement){case"outside":h=t=>t.x0<e/2?t.x0:t.x1;a=t=>t.y0+(t.y1-t.y0)/2;l=t=>t.x0<e/2?"-0.5em":"0.5em";r="0.4em";o=t=>t.x0<e/2?"end":"start";break;case"on-node":h=t=>t.x0+(t.x1-t.x0)/2;a=t=>t.y0+(t.y1-t.y0)/2;l="0.0em";r="0.4em";o="middle";break;case"inside":h=t=>t.x0<e/2?t.x1:t.x0;a=t=>t.y0+(t.y1-t.y0)/2;l=t=>t.x0<e/2?"0.5em":"-0.5em";r="0.4em";o=t=>t.x0<e/2?"start":"end";break;default:h=t=>t.x0<e/2?t.x1:t.x0;a=t=>t.y0+(t.y1-t.y0)/2;l=t=>t.x0<e/2?"0.5em":"-0.5em";r="0.4em";o=t=>t.x0<e/2?"start":"end";break}}t.attr("x",h).attr("y",a).attr("dx",l).attr("dy",r).attr("data-dx",l).attr("data-dy",r).attr("text-anchor",o)}enterNodeLabels(){this.enteringLabels.interrupt();const t=this.dataLabel.visible?1:0;const i=this.dataLabel.visible?Number.EPSILON:0;this.widthAllNodesNoLinks=this.nodeCount*this.nodeConfig.width+this.nodeCount*this.nodeConfig.width;this.noLinksLeftPadding=(this.innerPaddedWidth-this.widthAllNodesNoLinks)/2;this.enteringLabels.attr("class","alluvial-diagram-dataLabel entering").attr("cursor",!this.suppressEvents&&this.dataLabel.visible?this.cursor:null).attr("opacity",(s=>{if(this.linkConfig.visible){let e=true;if(s[this.sourceLinksString].length){e=s[this.sourceLinksString].some((i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}if(s[this.targetLinksString].length){e=s[this.targetLinksString].some((i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}return e?i:0}else{return s.layer===0?i:s.layer===this.nodeCount?i:0}}));this.placeNodeLabels({root:this.enteringLabels,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}updateNodeLabels(){this.updatingLabels.interrupt("label_opacity");const t=this.dataLabel.visible?1:0;this.updatingLabels.transition("label_opacity").ease(n).duration(((t,i,s)=>{if(a(s[i]).classed("entering")){return this.duration/3}return 0})).delay(((t,i,s)=>a(s[i]).classed("entering")?this.duration/1.2:0)).attr("opacity",(i=>{if(this.linkConfig.visible){let s=true;if(i[this.sourceLinksString].length){s=i[this.sourceLinksString].some((i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}if(i[this.targetLinksString].length){s=i[this.targetLinksString].some((i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}return s?1:0}else{return i.layer===0?t:i.layer===this.nodeCount?t:0}}))}exitNodeLabels(){this.exitingLabels.interrupt();this.exitingLabels.transition("exit_labels").duration(this.duration/3).ease(n).attr("opacity",0).remove()}addStrokeUnder(){const t=et({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.updatingLabels.attr("filter",t)}drawNodeLabels(){const t=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;const i=t?0:4;this.widthAllNodesNoLinks=this.nodeCount*this.nodeConfig.width*2;this.noLinksLeftPadding=(this.innerPaddedWidth-this.widthAllNodesNoLinks)/2;const s=this.updatingLabels.text((t=>this.dataLabel.format?lt(t,this.innerLabelAccessor,this.dataLabel.format):t[this.innerLabelAccessor])).attr("data-x",(t=>this.layout==="vertical"?t.x0+(t.x1-t.x0)/2:this.dataLabel.placement==="outside"?t.x0<this.innerPaddedWidth/2?t.x0-i:t.x1+i:t.x0<this.innerPaddedWidth/2?t.x1+i:t.x0-i)).attr("data-y",(t=>this.layout==="vertical"?this.dataLabel.placement==="outside"?t.y0<this.innerPaddedWidth/2?t.y0-i:t.y1+i:t.y0<this.innerPaddedWidth/2?t.y1+i:t.y0-i:t.y0+(t.y1-t.y0)/2)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-use-dx",t).attr("data-use-dy",t).transition("update_labels").duration(((t,i,s)=>a(s[i]).classed("entering")?this.duration/3:this.duration)).delay(((t,i,s)=>a(s[i]).classed("entering")?this.duration/1.2:0)).ease(n);if(this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly)){const e=this.dataLabel&&this.dataLabel.collisionPlacement;const h=this.updateNodes.select(".alluvial-node").attr("data-x",(t=>t.x0)).attr("data-y",(t=>t.y0)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-height",(t=>t.y1-t.y0)).attr("data-width",(t=>t.x1-t.x0)).each(((s,h,l)=>{if(!t){const t=l[h];const r=t.parentNode;const o="alluvial-node-collision-clone";const n=t.cloneNode();a(n).classed("alluvial-node",false).classed(o,true).classed("entering",false).data([s]).attr("focusable",false).attr("aria-label",null).attr("aria-hidden",true).attr("role",null).style("pointer-events","none").style("visibility","hidden").attr("tabindex",null).attr("data-x",this.layout==="vertical"?s.x0:e==="all"?s.x0:e==="outside"?s.x0<this.innerPaddedWidth/2?s.x0-i:s.x1+i:s.x0<this.innerPaddedWidth/2?s.x1+i:s.x0-i).attr("data-y",this.layout==="vertical"?e==="all"?s.y0:e==="outside"?s.y0<this.innerPaddedWidth/2?s.y0-i:s.y1+i:s.y0<this.innerPaddedWidth/2?s.y1+i:s.y0-i:s.y0).attr("data-width",this.layout==="vertical"?s.x1-s.x0:e==="all"?s.x1-s.x0:1).attr("data-height",this.layout==="vertical"?e==="all"?s.y1-s.y0:1:s.y1-s.y0);r.appendChild(n)}}));const l=this.updateNodes.select(".alluvial-node-collision-clone");this.bitmaps=X({labelSelection:s,avoidMarks:t?[h]:[h,l],validPositions:t?["middle"]:this.layout==="vertical"?["top","bottom"]:["left","right"],offsets:t?[1]:[4,4],accessors:[this.innerIDAccessor],size:[Q(this.width,0),Q(this.height,0)],hideOnly:this.dataLabel.visible&&t});l.remove();if(t){this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}}else{this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}s.call(Y,(()=>{this.updatingLabels.classed("entering",false);this.addStrokeUnder()}))}setNodeLabelOpacity(){this.updatingLabels.interrupt("label_opacity");const t=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;const i=t?0:4;const s=this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly);const e=this.dataLabel.visible?1:0;this.updatingLabels.attr("opacity",((t,i,h)=>{const l=+a(h[i]).attr("opacity");const r=a(h[i]).style("visibility");let o;if(this.linkConfig.visible){let i=true;if(t[this.sourceLinksString].length){i=t[this.sourceLinksString].some((t=>it(t.data,e,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}if(t[this.targetLinksString].length){i=t[this.targetLinksString].some((t=>it(t.data,e,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys)>=1))}o=i?e:0}else{o=t.layer===0?e:t.layer===this.nodeCount?e:0}if((o===1&&r==="hidden"||l!==o)&&s){if(o===1){a(h[i]).classed("collision-added",true).style("visibility",null)}else{a(h[i]).classed("collision-removed",true)}}return o}));if(s){const s=this.updatingLabels.filter(((t,i,s)=>a(s[i]).classed("collision-added")));const e=this.updatingLabels.filter(((t,i,s)=>a(s[i]).classed("collision-removed"))).attr("data-use-dx",t).attr("data-use-dy",t);if(e.size()>0){this.bitmaps=X({bitmaps:this.bitmaps,labelSelection:e,avoidMarks:[],validPositions:["middle"],offsets:[1],accessors:["key"],size:[Q(this.width,0),Q(this.height,0)],hideOnly:false,removeOnly:true});e.classed("collision-removed",false)}if(s.size()>0){const e=this.dataLabel&&this.dataLabel.collisionPlacement;const h=this.updateNodes.select(".alluvial-node").attr("data-x",(t=>t.x0)).attr("data-y",(t=>t.y0)).attr("data-translate-x",this.padding.left+this.margin.left).attr("data-translate-y",this.padding.top+this.margin.top).attr("data-height",(t=>t.y1-t.y0)).attr("data-width",(t=>t.x1-t.x0)).each(((s,h,l)=>{if(!t){const t=l[h];const r=t.parentNode;const o="alluvial-node-collision-clone";const n=t.cloneNode();a(n).classed("alluvial-node",false).classed(o,true).classed("entering",false).data([s]).attr("focusable",false).attr("aria-label",null).attr("aria-hidden",true).attr("role",null).style("pointer-events","none").style("visibility","hidden").attr("tabindex",null).attr("data-x",this.layout==="vertical"?s.x0:e==="all"?s.x0:e==="outside"?s.x0<this.innerPaddedWidth/2?s.x0-i:s.x1+i:s.x0<this.innerPaddedWidth/2?s.x1+i:s.x0-i).attr("data-y",this.layout==="vertical"?e==="all"?s.y0:e==="outside"?s.y0<this.innerPaddedWidth/2?s.y0-i:s.y1+i:s.y0<this.innerPaddedWidth/2?s.y1+i:s.y0-i:s.y0).attr("data-width",this.layout==="vertical"?s.x1-s.x0:e==="all"?s.x1-s.x0:1).attr("data-height",this.layout==="vertical"?e==="all"?s.y1-s.y0:1:s.y1-s.y0);r.appendChild(n)}}));const l=this.updateNodes.select(".alluvial-node-collision-clone");this.bitmaps=X({labelSelection:s,bitmaps:this.bitmaps,avoidMarks:t?[h]:[h,l],validPositions:t?["middle"]:this.layout==="vertical"?["top","bottom"]:["left","right"],offsets:t?[1]:[4,4],accessors:[this.innerIDAccessor],size:[Q(this.width,0),Q(this.height,0)],hideOnly:this.dataLabel.visible&&t,suppressMarkDraw:true});l.remove();if(t){this.placeNodeLabels({root:s,layout:this.layout,dataLabel:this.dataLabel,innerPaddedWidth:this.innerPaddedWidth})}s.classed("collision-added",false)}}}updateInteractionState(){this.removeTemporaryClickedLinks(this.svg.node());this.updateLinks.interrupt("opacity");const t=this.linkConfig.visible?this.linkConfig.opacity:0;this.updateLinks.attr("stroke-opacity",(i=>it(i.data,t,this.hoverOpacity,this.hoverHighlight,this.clickHighlight,this.innerInteractionKeys))).attr("stroke",(t=>this.clickHighlight.length>0&&tt(t.data,this.clickHighlight,this.innerInteractionKeys)&&this.clickStyle.color?xt[this.clickStyle.color]||this.clickStyle.color:this.hoverHighlight&&ut(t.data,this.hoverHighlight,this.innerInteractionKeys)&&this.hoverStyle.color?xt[this.hoverStyle.color]||this.hoverStyle.color:this.innerLinkFillMode==="group"?this.colorArr[this.groupKeys.indexOf(t[this.groupAccessor])]:this.innerLinkFillMode==="none"?this.colorArr[0]||"#E4E4E4":this.innerLinkFillMode==="link"?this.colorArr[t.index]:this.innerLinkFillMode==="source"?this.colorArr[t.source.index]:this.colorArr[t.target.index]));this.updateLinks.each(((t,i,s)=>{const e=this.clickHighlight&&this.clickHighlight.length>0&&tt(t.data,this.clickHighlight,this.innerInteractionKeys);if(e){this.drawDuplicateClickedLink(s[i],t)}}))}bindInteractivity(){this.updateLinks.on("click",!this.suppressEvents?(t,i,s)=>this.onClickHandler(t,s[i]):null).on("mouseover",!this.suppressEvents?(t,i,s)=>this.onHoverHandler(t,s[i]):null).on("mouseout",!this.suppressEvents?()=>this.onMouseOutHandler():null)}drawAnnotations(){const t=this.preppedData;const i=[];this.annotations.forEach((s=>{const e=Object.assign({},s);let h=s.data;if(t&&h){if(e.positionType==="node"&&e.data.hasOwnProperty(this.innerIDAccessor)){const i=t.nodes.findIndex((t=>t[this.innerIDAccessor]===e.data[this.innerIDAccessor]));h=t.nodes[i]}else if(e.positionType==="source"||e.positionType==="target"&&e.data.hasOwnProperty(this.sourceAccessor)&&e.data.hasOwnProperty(this.targetAccessor)){const i=t.links.findIndex((t=>t.data[this.sourceAccessor]===e.data[this.sourceAccessor]&&t.data[this.targetAccessor]===e.data[this.targetAccessor]));h=t.links[i]}}if(e.positionType&&h){if(e.positionType==="target"&&h.target){e.x=h.target.x0;e.y=h.y1}else if(e.positionType==="source"&&h.source){e.x=h.source.x1;e.y=h.y0}else if(e.positionType==="node"){e.x=h.x1;e.y=(h.y1+h.y0)/2}}delete e.data;i.push(e)}));Z({source:this.rootG.node(),data:i,ignoreScales:true,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps})}setSubTitleElements(){Ct({root:this.subTitleG,subTitle:this.subTitle})}setColors(){this.colorArr=this.colors?st(this.colors):ot(this.colorPalette,this.nodeList.length)}setTagLevels(){this.topLevel=at(this.highestHeadingLevel);this.bottomLevel=at(this.highestHeadingLevel,3)}setChartDescriptionWrapper(){S({language:this.getLanguageString(),rootEle:this.alluvialDiagramEl,title:this.accessibility.title||this.mainTitle,chartTag:"alluvial-diagram",uniqueID:this.chartID,highestHeadingLevel:this.highestHeadingLevel,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled,hideDataTable:this.accessibility.hideDataTableButton});this.shouldRedrawWrapper=false}setParentSVGAccessibility(){const t=pt(this,vt,"alluvial-diagram");N({language:this.getLanguageString(),node:this.svg.node(),chartTag:"alluvial-diagram",title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"link",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupAccessor:this.innerIDAccessor,groupKeys:["value"],groupName:"node",disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})}setGeometryAccessibilityAttributes(){this.updateLinks.each(((t,i,s)=>{I(s[i])}))}setGeometryAriaLabels(){const t=pt(this,vt,"alluvial-diagram");this.updateLinks.each(((i,s,e)=>{j({node:e[s],geomType:"link",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:t,dataKeyNames:this.dataKeyNames,groupName:"node",uniqueID:this.chartID,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled});P({node:e[s],uniqueID:this.chartID})}))}setGroupAccessibilityID(){this.updateNodes.each(((t,i,s)=>{P({node:s[i],uniqueID:this.chartID})}))}setChartCountAccessibility(){O({rootEle:this.alluvialDiagramEl,parentGNode:this.linkG.node(),chartTag:"alluvial-diagram",geomType:"link",groupName:"node"})}setSelectedClass(){this.updateLinks.classed("highlight",(t=>{const i=it(t.data,true,false,"",this.clickHighlight,this.innerInteractionKeys);return this.clickHighlight&&this.clickHighlight.length?i:false})).each(((t,i,s)=>{let e=it(t.data,true,false,"",this.clickHighlight,this.innerInteractionKeys);e=this.clickHighlight&&this.clickHighlight.length?e:false;const h=this.accessibility.elementsAreInterface;B(s[i],e,h)}))}setChartAccessibilityTitle(){G(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.title||this.mainTitle)}setChartAccessibilitySubtitle(){K(this.getLanguageString(),this.alluvialDiagramEl,this.subTitle)}setChartAccessibilityLongDescription(){H(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.longDescription)}setChartAccessibilityExecutiveSummary(){M(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.executiveSummary)}setChartAccessibilityPurpose(){_(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.purpose)}setChartAccessibilityContext(){q(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.contextExplanation)}setChartAccessibilityStatisticalNotes(){$(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.statisticalNotes)}setChartAccessibilityStructureNotes(){V(this.getLanguageString(),this.alluvialDiagramEl,this.accessibility.structureNotes)}setAnnotationAccessibility(){F(this.getLanguageString(),this.alluvialDiagramEl,this.annotations,undefined)}onChangeHandler(){if(this.accessibility&&typeof this.accessibility.onChangeFunc==="function"){const t={updated:this.updated,added:this.enterSize,removed:this.exitSize};this.accessibility.onChangeFunc(t)}this.updated=false;this.enterSize=0;this.exitSize=0}onClickHandler(t,i){this.clickEvent.emit({data:t.data,target:i})}onHoverHandler(t,i){ft(this.chartID,true);this.hoverEvent.emit({data:t.data,target:i});if(this.showTooltip){this.eventsTooltip({data:t.data,evt:l,isToShow:true})}}onMouseOutHandler(){ft(this.chartID,false);this.mouseOutEvent.emit();if(this.showTooltip){this.eventsTooltip({isToShow:false})}}setTooltipInitialStyle(){dt(this.tooltipG)}eventsTooltip({data:t,evt:i,isToShow:s}){ht({root:this.tooltipG,data:t,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataKeyNames:this.dataKeyNames,groupAccessor:this.groupAccessor,xAccessor:this.sourceAccessor,yAccessor:this.targetAccessor,valueAccessor:this.valueAccessor,ordinalAccessor:this.innerIDAccessor,chartType:"alluvial-diagram"})}render(){this.drawStartEvent.emit({chartID:this.chartID});this.init();if(this.shouldSetLocalizationConfig){this.setLocalizationConfig();this.shouldSetLocalizationConfig=false}if(this.shouldSetTagLevels){this.setTagLevels();this.shouldSetTagLevels=false}if(this.shouldUpdateData){this.prepareData();this.shouldUpdateData=false}if(this.shouldSetDimensions){this.setDimensions();this.shouldSetDimensions=false}if(this.shouldValidateLabelText){this.validateLabelText();this.shouldValidateLabelText=false}if(this.shouldValidateLinkFillMode){this.validateLinkFillMode();this.shouldValidateLinkFillMode=false}if(this.shouldValidateNodeAlignment){this.validateNodeAlignment();this.shouldValidateNodeAlignment=false}if(this.shouldValidateInteractionKeys){this.validateInteractionKeys();this.shouldValidateInteractionKeys=false}if(this.shouldValidateLinkGroups){this.validateLinkGroups();this.shouldValidateLinkGroups=true}if(this.shouldValidateLocalization){this.shouldValidateLocalizationProps();this.shouldValidateLocalization=false}if(this.shouldValidateAccessibility){this.shouldValidateAccessibilityProps();this.shouldValidateAccessibility=false}if(this.shouldSetColors){this.setColors();this.shouldSetColors=false}if(this.shouldValidateIdAccessor){this.validateIdAccessor();this.shouldValidateIdAccessor=false}if(this.shouldSetNodeDimensions){this.setNodeDimensions();this.shouldSetNodeDimensions=false}if(this.shouldCallSankeyGenerator){this.callSankeyGenerator();this.shouldCallSankeyGenerator=false}if(this.shouldUpdateTableData){this.setTableData();this.shouldUpdateTableData=false}return s("div",{key:"239c56c8813ca9ffefb27d79889feb960f65ff68"},s("div",{key:"bfab71f0780570d3bee705f2d1b093d5a875fc66",class:"o-layout"},s("div",{key:"cb27635d243133f9b1317267d99bce5e27e0f602",class:"o-layout--chart"},s(this.topLevel,{key:"fa079bd089cf7c9301e92e4c4d7f76a6c366a80a",class:"alluvial-main-title vcl-main-title"},this.mainTitle),s(this.bottomLevel,{key:"47a02cb194c81d3af40fc4bd96b331bef78e94bb",class:"visa-ui-text--instructions alluvial-sub-title vcl-sub-title"}),s("keyboard-instructions",{key:"4e1228172a9f711a998893030dadd178c6147aa0",uniqueID:this.chartID,geomType:"node",groupName:"node collection",language:this.getLanguageString(),chartTag:"alluvial-diagram",width:this.width-(this.margin?this.margin.right||0:0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:this.innerLinkFillMode==="source"||this.innerLinkFillMode==="target",disabled:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),s("div",{key:"d7c323ed2c41ca0084e4bde0a6c6236265962d2e",class:"visa-viz-d3-alluvial-container"}),s("div",{key:"2646ae41d976cc731b21018bfa04eaf7d3ae9f36",class:"alluvial-tooltip vcl-tooltip",style:{display:this.showTooltip?"block":"none"}}),s("data-table",{key:"3b94a8ba0b713d508aeed3c208a15b29f3b2c39e",uniqueID:this.chartID,isCompact:true,language:this.getLanguageString(),tableColumns:this.tableColumns,dataKeyNames:this.dataKeyNames,data:this.tableData,secondaryData:this.secondaryTableData,secondaryTableColumns:this.secondaryTableColumns,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton,unitTest:this.unitTest}))))}init(){const t=Object.keys(x);let i=0;const s={hoverOpacity:{exception:0},showTooltip:{exception:false},mainTitle:{exception:""},subTitle:{exception:""},linkConfig:Object.assign({exception:false})};for(i=0;i<t.length;i++){const e=!s[t[i]]?false:this[t[i]]===s[t[i]].exception;this[t[i]]=this[t[i]]||e?this[t[i]]:x[t[i]]}}get alluvialDiagramEl(){return e(this)}static get watchers(){return{nodeData:["dataWatcher"],linkData:["dataWatcher"],uniqueID:["idWatcher"],highestHeadingLevel:["headingWatcher"],mainTitle:["mainTitleWatcher"],subTitle:["subTitleWatcher"],height:["dimensionWatcher"],width:["dimensionWatcher"],padding:["dimensionWatcher"],margin:["dimensionWatcher"],layout:["layoutWatcher"],sourceAccessor:["sourceAccessorWatcher"],targetAccessor:["targetAccessorWatcher"],valueAccessor:["valueAccessorWatcher"],groupAccessor:["groupAccessorWatcher"],nodeIDAccessor:["nodeIDAccessorWatcher"],nodeConfig:["nodeConfigWatcher"],linkConfig:["linkConfigWatcher"],colors:["colorWatcher"],colorPalette:["colorWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],hoverOpacity:["hoverOpacityWatcher"],dataLabel:["dataLabelWatcher"],tooltipLabel:["tooltipLabelWatcher"],showTooltip:["showTooltipWatcher"],accessibility:["accessibilityWatcher"],localization:["localizationWatcher"],annotations:["annotationsWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],interactionKeys:["interactionWatcher"],dataKeyNames:["dataKeyNamesWatcher"],suppressEvents:["suppressWatcher"],unitTest:["unitTestWatcher"]}}};Dt.style=T;export{Dt as alluvial_diagram};
//# sourceMappingURL=p-3e6a1502.entry.js.map